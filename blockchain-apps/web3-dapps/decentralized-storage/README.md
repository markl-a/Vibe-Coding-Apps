# ğŸ’¾ Decentralized Storage - å»ä¸­å¿ƒåŒ–å­˜å„²

åŸºæ–¼ IPFS å’Œ Filecoin çš„å»ä¸­å¿ƒåŒ–æ–‡ä»¶å­˜å„²æ‡‰ç”¨ï¼Œçµåˆ AI å¯¦ç¾æ™ºèƒ½æ–‡ä»¶ç®¡ç†å’Œæœç´¢ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ” å»ä¸­å¿ƒåŒ–å­˜å„²åŠŸèƒ½
- **IPFS å­˜å„²** - å¿«é€Ÿçš„åˆ†å¸ƒå¼æ–‡ä»¶å­˜å„²
- **Filecoin å‚™ä»½** - é•·æœŸæŒä¹…åŒ–å­˜å„²
- **åŠ å¯†æ–‡ä»¶å…±äº«** - åŸºæ–¼ Lit Protocol çš„è¨ªå•æ§åˆ¶
- **ç‰ˆæœ¬æ§åˆ¶** - æ–‡ä»¶ç‰ˆæœ¬ç®¡ç†å’Œå›æ»¾
- **æ–‡ä»¶å¸‚å ´** - å»ä¸­å¿ƒåŒ–æ–‡ä»¶äº¤æ˜“å¸‚å ´

### ğŸ¤– AI æ™ºèƒ½åŠŸèƒ½
- **æ™ºèƒ½åˆ†é¡** - AI è‡ªå‹•è­˜åˆ¥æ–‡ä»¶é¡å‹å’Œå…§å®¹
- **å…§å®¹æå–** - å¾åœ–ç‰‡ã€PDF ç­‰æå–æ–‡æœ¬
- **èªç¾©æœç´¢** - åŸºæ–¼å…§å®¹çš„æ™ºèƒ½æœç´¢
- **è‡ªå‹•æ¨™ç±¤** - AI ç”Ÿæˆæ–‡ä»¶æ¨™ç±¤
- **ç›¸ä¼¼æ–‡ä»¶æ¨è–¦** - æ‰¾åˆ°ç›¸é—œæ–‡ä»¶
- **æ™ºèƒ½å£“ç¸®** - AI å„ªåŒ–æ–‡ä»¶å¤§å°

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### å­˜å„²å±¤
```
Decentralized Storage
â”œâ”€â”€ IPFS - å…§å®¹å°‹å€å­˜å„²
â”‚   â”œâ”€â”€ å¿«é€Ÿä¸Šå‚³/ä¸‹è¼‰
â”‚   â””â”€â”€ å…§å®¹å»é‡
â”œâ”€â”€ Filecoin - æŒä¹…åŒ–å­˜å„²
â”‚   â”œâ”€â”€ å­˜å„²äº¤æ˜“
â”‚   â””â”€â”€ æª¢ç´¢äº¤æ˜“
â””â”€â”€ Arweave - æ°¸ä¹…å­˜å„²ï¼ˆå¯é¸ï¼‰
```

### æ™ºèƒ½åˆç´„
```
Smart Contracts
â”œâ”€â”€ FileStorage.sol - æ–‡ä»¶å…ƒæ•¸æ“šç®¡ç†
â”œâ”€â”€ AccessControl.sol - è¨ªå•æ¬Šé™æ§åˆ¶
â”œâ”€â”€ FileMarket.sol - æ–‡ä»¶äº¤æ˜“å¸‚å ´
â””â”€â”€ StorageToken.sol - å­˜å„²æ”¯ä»˜ä»£å¹£
```

### AI æœå‹™
```
AI Integration
â”œâ”€â”€ æ–‡ä»¶è­˜åˆ¥ - GPT-4 Vision
â”œâ”€â”€ å…§å®¹æå– - OCR + NLP
â”œâ”€â”€ èªç¾©æœç´¢ - Embeddings
â””â”€â”€ æ™ºèƒ½æ¨™ç±¤ - Auto-tagging
```

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
decentralized-storage/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/         # React çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ FileUpload.tsx
â”‚   â”‚   â”œâ”€â”€ FileList.tsx
â”‚   â”‚   â”œâ”€â”€ FileViewer.tsx
â”‚   â”‚   â”œâ”€â”€ ShareDialog.tsx
â”‚   â”‚   â””â”€â”€ SearchBar.tsx
â”‚   â”œâ”€â”€ hooks/             # è‡ªå®šç¾© Hooks
â”‚   â”‚   â”œâ”€â”€ useStorage.ts
â”‚   â”‚   â”œâ”€â”€ useEncryption.ts
â”‚   â”‚   â””â”€â”€ useAISearch.ts
â”‚   â”œâ”€â”€ contracts/         # æ™ºèƒ½åˆç´„
â”‚   â”‚   â”œâ”€â”€ FileStorage.sol
â”‚   â”‚   â”œâ”€â”€ AccessControl.sol
â”‚   â”‚   â”œâ”€â”€ FileMarket.sol
â”‚   â”‚   â””â”€â”€ StorageToken.sol
â”‚   â”œâ”€â”€ ai/               # AI æ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ fileClassifier.ts
â”‚   â”‚   â”œâ”€â”€ contentExtractor.ts
â”‚   â”‚   â”œâ”€â”€ semanticSearch.ts
â”‚   â”‚   â””â”€â”€ autoTagging.ts
â”‚   â”œâ”€â”€ utils/            # å·¥å…·å‡½æ•¸
â”‚   â”‚   â”œâ”€â”€ ipfs.ts
â”‚   â”‚   â”œâ”€â”€ filecoin.ts
â”‚   â”‚   â””â”€â”€ encryption.ts
â”‚   â””â”€â”€ App.tsx
â”œâ”€â”€ tests/
â”œâ”€â”€ scripts/
â””â”€â”€ package.json
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å®‰è£ä¾è³´

```bash
npm install
```

### 2. ç’°å¢ƒé…ç½®

å‰µå»º `.env` æ–‡ä»¶ï¼š

```env
# Web3
VITE_WALLETCONNECT_PROJECT_ID=your_project_id

# IPFS
VITE_WEB3_STORAGE_TOKEN=your_token
VITE_IPFS_API_URL=https://ipfs.infura.io:5001
VITE_IPFS_GATEWAY=https://ipfs.io/ipfs/

# Filecoin
VITE_FILECOIN_API_URL=https://api.node.glif.io

# Lit Protocol
VITE_LIT_NETWORK=serrano

# AI
VITE_OPENAI_API_KEY=your_key

# Contracts
VITE_FILE_STORAGE_CONTRACT=0x...
VITE_ACCESS_CONTROL_CONTRACT=0x...
```

### 3. éƒ¨ç½²åˆç´„

```bash
npm run compile
npm run deploy
```

### 4. å•Ÿå‹•æ‡‰ç”¨

```bash
npm run dev
```

## ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½å¯¦ç¾

### 1. ä¸Šå‚³æ–‡ä»¶åˆ° IPFS

```typescript
import { useStorage } from '@/hooks/useStorage';

function FileUpload() {
  const { uploadFile, isUploading } = useStorage();

  const handleUpload = async (file: File) => {
    // AI åˆ†ææ–‡ä»¶
    const analysis = await analyzeFile(file);

    // ä¸Šå‚³åˆ° IPFS
    const cid = await uploadFile(file, {
      encrypt: true,
      tags: analysis.tags,
      category: analysis.category,
    });

    console.log('Uploaded:', cid);
  };

  return (
    <input
      type="file"
      onChange={(e) => e.target.files?.[0] && handleUpload(e.target.files[0])}
      disabled={isUploading}
    />
  );
}
```

### 2. åŠ å¯†æ–‡ä»¶å…±äº«

```typescript
import { useEncryption } from '@/hooks/useEncryption';

function ShareFile({ fileId }: { fileId: string }) {
  const { shareFile } = useEncryption();

  const handleShare = async (recipientAddress: string) => {
    // ä½¿ç”¨ Lit Protocol åŠ å¯†ä¸¦æˆæ¬Š
    await shareFile(fileId, [recipientAddress], {
      expiry: Date.now() + 7 * 24 * 60 * 60 * 1000, // 7å¤©
      canDownload: true,
      canReshare: false,
    });
  };

  return <ShareDialog onShare={handleShare} />;
}
```

### 3. AI èªç¾©æœç´¢

```typescript
import { useAISearch } from '@/hooks/useAISearch';

function SmartSearch() {
  const { search, results } = useAISearch();

  const handleSearch = async (query: string) => {
    // AI ç†è§£æŸ¥è©¢æ„åœ–
    const results = await search(query);
    // è¿”å›èªç¾©ç›¸é—œçš„æ–‡ä»¶
  };

  return (
    <div>
      <input
        type="text"
        placeholder="æœç´¢æ–‡ä»¶..."
        onChange={(e) => handleSearch(e.target.value)}
      />
      {results.map((file) => (
        <FileCard key={file.id} file={file} />
      ))}
    </div>
  );
}
```

### 4. ç‰ˆæœ¬æ§åˆ¶

```typescript
import { useStorage } from '@/hooks/useStorage';

function FileVersions({ fileId }: { fileId: string }) {
  const { getVersions, revertToVersion } = useStorage();

  const versions = await getVersions(fileId);

  return (
    <div>
      {versions.map((version) => (
        <div key={version.cid}>
          <span>{version.timestamp}</span>
          <button onClick={() => revertToVersion(fileId, version.cid)}>
            æ¢å¾©æ­¤ç‰ˆæœ¬
          </button>
        </div>
      ))}
    </div>
  );
}
```

### 5. æ–‡ä»¶å¸‚å ´

```typescript
import { useMarket } from '@/hooks/useMarket';

function FileMarket() {
  const { listFile, buyFile } = useMarket();

  const handleList = async (fileId: string, price: bigint) => {
    await listFile(fileId, price, {
      license: 'personal',
      duration: 'lifetime',
    });
  };

  const handleBuy = async (listingId: bigint) => {
    const receipt = await buyFile(listingId);
    // ç²å¾—æ–‡ä»¶è¨ªå•æ¬Šé™
  };

  return <Marketplace onList={handleList} onBuy={handleBuy} />;
}
```

## ğŸ§ª æ¸¬è©¦

```bash
# é‹è¡Œæ‰€æœ‰æ¸¬è©¦
npm test

# æ¸¬è©¦ UI
npm run test:ui

# æ¸¬è©¦åˆç´„
npx hardhat test
```

## ğŸ“Š æ™ºèƒ½åˆç´„æ¥å£

### FileStorage.sol

```solidity
// ä¸Šå‚³æ–‡ä»¶å…ƒæ•¸æ“š
function uploadFile(
    string memory cid,
    string memory name,
    uint256 size,
    string[] memory tags
) external returns (uint256);

// æ›´æ–°æ–‡ä»¶
function updateFile(uint256 fileId, string memory newCid) external;

// ç²å–æ–‡ä»¶ä¿¡æ¯
function getFile(uint256 fileId) external view returns (File memory);

// åˆ†äº«æ–‡ä»¶
function shareFile(uint256 fileId, address recipient) external;
```

### AccessControl.sol

```solidity
// æˆäºˆè¨ªå•æ¬Šé™
function grantAccess(
    uint256 fileId,
    address user,
    uint256 expiry
) external;

// æ’¤éŠ·æ¬Šé™
function revokeAccess(uint256 fileId, address user) external;

// æª¢æŸ¥æ¬Šé™
function hasAccess(uint256 fileId, address user)
    external view returns (bool);
```

## ğŸ¤– AI åŠŸèƒ½ API

### æ–‡ä»¶åˆ†é¡

```typescript
const analysis = await classifyFile(file);
// {
//   category: 'document',
//   type: 'pdf',
//   confidence: 0.95,
//   tags: ['æŠ€è¡“', 'å€å¡Šéˆ', 'Web3']
// }
```

### å…§å®¹æå–

```typescript
const content = await extractContent(file);
// {
//   text: 'æ–‡ä»¶å…§å®¹...',
//   images: ['data:...'],
//   metadata: { author: '...', created: '...' }
// }
```

### èªç¾©æœç´¢

```typescript
const results = await semanticSearch('å€å¡Šéˆç›¸é—œæ–‡æª”');
// è¿”å›èªç¾©ç›¸é—œçš„æ–‡ä»¶ï¼Œå³ä½¿ä¸åŒ…å«é—œéµè©
```

## ğŸ”§ é€²éšåŠŸèƒ½

### 1. è‡ªå‹•å‚™ä»½åˆ° Filecoin

```typescript
// é…ç½®è‡ªå‹•å‚™ä»½ç­–ç•¥
await configureBackup({
  provider: 'filecoin',
  schedule: 'daily',
  retention: '1 year',
  replication: 3,
});
```

### 2. CDN åŠ é€Ÿ

```typescript
// ä½¿ç”¨ Cloudflare IPFS Gateway
const url = getIPFSUrl(cid, {
  gateway: 'cloudflare',
  cache: true,
});
```

### 3. æ–‡ä»¶åŠ å¯†é¸é …

```typescript
await uploadFile(file, {
  encryption: {
    algorithm: 'AES-256-GCM',
    accessControl: 'lit-protocol',
    conditions: [
      { type: 'wallet', address: '0x...' },
      { type: 'nft', contract: '0x...', tokenId: '1' },
    ],
  },
});
```

## ğŸ“ˆ æ€§èƒ½å„ªåŒ–

- âœ… åˆ†ç‰‡ä¸Šå‚³å¤§æ–‡ä»¶
- âœ… æ–·é»çºŒå‚³
- âœ… ä¸¦è¡Œä¸Šå‚³å¤šå€‹æ–‡ä»¶
- âœ… åœ–ç‰‡è‡ªå‹•å£“ç¸®
- âœ… æ¼¸é€²å¼åŠ è¼‰
- âœ… æ™ºèƒ½ç·©å­˜ç­–ç•¥

## ğŸ” å®‰å…¨ç‰¹æ€§

- âœ… ç«¯åˆ°ç«¯åŠ å¯†
- âœ… é›¶çŸ¥è­˜è­‰æ˜è¨ªå•æ§åˆ¶
- âœ… æ–‡ä»¶å®Œæ•´æ€§é©—è­‰
- âœ… æƒ¡æ„æ–‡ä»¶æƒæ
- âœ… DDoS é˜²è­·
- âœ… éš±ç§ä¿è­·

## ğŸ“š å­¸ç¿’è³‡æº

- [IPFS æ–‡æª”](https://docs.ipfs.tech/)
- [Filecoin æ–‡æª”](https://docs.filecoin.io/)
- [Web3.Storage](https://web3.storage/docs/)
- [Lit Protocol](https://developer.litprotocol.com/)

## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ æˆæ¬Š

MIT License

---

**å»ä¸­å¿ƒåŒ–å­˜å„²çš„æœªä¾†** ğŸš€
