#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run lint-staged for JS/TS files
pnpm lint-staged

# Run Python formatters and linters
echo "Running Python code quality checks..."

# Find all staged Python files
PYTHON_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.py$')

if [ -n "$PYTHON_FILES" ]; then
    echo "Formatting Python files with black..."
    echo "$PYTHON_FILES" | xargs black

    echo "Linting Python files with ruff..."
    echo "$PYTHON_FILES" | xargs ruff check --fix

    # Re-add formatted files
    echo "$PYTHON_FILES" | xargs git add
fi

echo "Pre-commit checks completed!"
