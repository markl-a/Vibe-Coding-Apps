# ğŸ¨ å…§å®¹å¢å¼·å·¥å…· - Content Enhancer Extension

> ğŸš€ **AI è¼”åŠ©é–‹ç™¼çš„æ™ºèƒ½ç¶²é é«”é©—å¢å¼·å·¥å…·**

ä¸€å€‹å¤šåŠŸèƒ½çš„ç€è¦½å™¨æ“´å……åŠŸèƒ½ï¼Œæä¾›æš—è‰²æ¨¡å¼ã€é–±è®€æ¨¡å¼ã€å­—é«”èª¿æ•´ã€å»£å‘Šéæ¿¾ç­‰ç¶²é ç€è¦½å¢å¼·åŠŸèƒ½ï¼Œè®“æ‚¨çš„ç€è¦½é«”é©—æ›´åŠ èˆ’é©ã€‚

## ğŸ“‹ å°ˆæ¡ˆç›®æ¨™

æå‡ç¶²é ç€è¦½é«”é©—ï¼Œè®“ä½¿ç”¨è€…èƒ½å¤ ï¼š
- è‡ªè¨‚ä»»ä½•ç¶²ç«™çš„è¦–è¦ºæ¨£å¼
- å•Ÿç”¨èˆ’é©çš„æš—è‰²æ¨¡å¼
- ä½¿ç”¨å°ˆæ³¨çš„é–±è®€æ¨¡å¼
- éæ¿¾å»£å‘Šå’Œå¹²æ“¾å…ƒç´ 
- èª¿æ•´å­—é«”å’Œæ’ç‰ˆ
- è‡ªå‹•ç¿»è­¯ç¶²é å…§å®¹

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. æ™ºèƒ½æš—è‰²æ¨¡å¼
- ğŸŒ™ ä¸€éµå•Ÿç”¨å…¨ç«™æš—è‰²æ¨¡å¼
- ğŸ¨ æ™ºèƒ½åè½‰é¡è‰²ï¼ˆä¿è­·åœ–ç‰‡ï¼‰
- âš™ï¸ äº®åº¦ã€å°æ¯”åº¦å¾®èª¿
- ğŸ“ ç¶²ç«™ç‰¹å®šè¨­å®šè¨˜æ†¶
- ğŸ• æ’ç¨‹è‡ªå‹•åˆ‡æ›ï¼ˆæ—¥å‡ºæ—¥è½ï¼‰
- ğŸ¯ AI å„ªåŒ–é…è‰²æ–¹æ¡ˆ

### 2. é–±è®€æ¨¡å¼
- ğŸ“– æå–ä¸»è¦æ–‡ç« å…§å®¹
- ğŸ”¤ å¯èª¿æ•´å­—é«”å¤§å°å’Œé–“è·
- ğŸ“ è‡ªè¨‚æ¬„å¯¬å’Œå°é½Š
- ğŸ¨ å¤šç¨®é–±è®€ä¸»é¡Œ
- ğŸ’¾ å„²å­˜æ–‡ç« ä¾›é›¢ç·šé–±è®€
- ğŸ”Š æ–‡å­—è½‰èªéŸ³ï¼ˆTTSï¼‰

### 3. å»£å‘Šå’Œå¹²æ“¾éæ¿¾
- ğŸš« æ™ºèƒ½å»£å‘Šæ””æˆª
- ğŸ¯ Cookie æ©«å¹…ç§»é™¤
- ğŸ”‡ è‡ªå‹•æ’­æ”¾å½±ç‰‡ç¦ç”¨
- âœ¨ å½ˆå‡ºè¦–çª—æ””æˆª
- ğŸ“Š å…ƒç´ éš±è—å·¥å…·
- ğŸ¤– AI è¾¨è­˜å¹²æ“¾å…§å®¹

### 4. å­—é«”å’Œæ’ç‰ˆ
- ğŸ”¤ æ›¿æ›ç¶²é å­—é«”
- ğŸ“ èª¿æ•´è¡Œé«˜å’Œå­—é–“è·
- ğŸ’ª å¼·åˆ¶æœ€å°å­—é«”å¤§å°
- ğŸ¨ è‡ªè¨‚é€£çµé¡è‰²
- âœï¸ æ³¨éŸ³/æ‹¼éŸ³è¼”åŠ©é¡¯ç¤º

### 5. é é¢è‡ªè¨‚ CSS
- ğŸ¨ æ³¨å…¥è‡ªè¨‚ CSS æ¨£å¼
- ğŸ’¾ å„²å­˜ç¶²ç«™ç‰¹å®šæ¨£å¼
- ğŸ“š æ¨£å¼ç¯„æœ¬åº«
- ğŸ”„ å³æ™‚é è¦½
- ğŸŒ åˆ†äº«å’ŒåŒ¯å…¥æ¨£å¼

### 6. ç¿»è­¯åŠŸèƒ½
- ğŸŒ æ•´é ç¿»è­¯
- ğŸ¯ é¸å–æ–‡å­—ç¿»è­¯
- ğŸ’¬ æ‡¸æµ®ç¿»è­¯è¦–çª—
- ğŸ—£ï¸ å¤šèªè¨€æ”¯æ´
- ğŸ¤– AI ç¿»è­¯æ•´åˆ

## ğŸ› ï¸ æŠ€è¡“æ£§

### å‰ç«¯æ¡†æ¶
- **React 18** + **TypeScript**
- **Tailwind CSS** - UI æ¨£å¼
- **Framer Motion** - å‹•ç•«æ•ˆæœ
- **Zustand** - ç‹€æ…‹ç®¡ç†

### ç€è¦½å™¨ API
- **Chrome Scripting API** - æ³¨å…¥è…³æœ¬
- **Chrome Storage API** - è¨­å®šå„²å­˜
- **Chrome DeclarativeNetRequest** - å»£å‘Šæ””æˆª
- **Chrome TTS API** - æ–‡å­—è½‰èªéŸ³

### æ ¸å¿ƒæŠ€è¡“
- **CSS Variables** - å‹•æ…‹ä¸»é¡Œ
- **MutationObserver** - DOM ç›£æ§
- **Readability.js** - æ–‡ç« æå–
- **CSS-in-JS** - å‹•æ…‹æ¨£å¼æ³¨å…¥

### å·¥å…·åº«
- **color** - é¡è‰²è™•ç†
- **@mozilla/readability** - é–±è®€æ¨¡å¼
- **turndown** - HTML è½‰ Markdown
- **franc** - èªè¨€æª¢æ¸¬

## ğŸš€ å¿«é€Ÿé–‹å§‹

### å®‰è£ä¾è³´

```bash
cd browser-extensions/content-enhancer
npm install
```

### é–‹ç™¼æ¨¡å¼

```bash
npm run dev

# è¼‰å…¥åˆ°ç€è¦½å™¨:
# chrome://extensions/ -> é–‹ç™¼è€…æ¨¡å¼ -> è¼‰å…¥æœªå°è£é …ç›®
```

### å»ºç½®

```bash
npm run build
```

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
content-enhancer/
â”œâ”€â”€ README.md
â”œâ”€â”€ package.json
â”œâ”€â”€ manifest.json
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ background/
â”‚   â”‚   â””â”€â”€ service-worker.ts      # èƒŒæ™¯æœå‹™
â”‚   â”œâ”€â”€ content/
â”‚   â”‚   â”œâ”€â”€ dark-mode.ts            # æš—è‰²æ¨¡å¼æ³¨å…¥
â”‚   â”‚   â”œâ”€â”€ reader-mode.ts          # é–±è®€æ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ ad-blocker.ts           # å»£å‘Šæ””æˆª
â”‚   â”‚   â”œâ”€â”€ font-customizer.ts      # å­—é«”è‡ªè¨‚
â”‚   â”‚   â””â”€â”€ translator.ts           # ç¿»è­¯åŠŸèƒ½
â”‚   â”œâ”€â”€ popup/
â”‚   â”‚   â”œâ”€â”€ Popup.tsx               # å½ˆå‡ºä»‹é¢
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ DarkModeToggle.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ReaderModeButton.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ FontSettings.tsx
â”‚   â”‚   â”‚   â””â”€â”€ QuickSettings.tsx
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ options/
â”‚   â”‚   â”œâ”€â”€ Options.tsx             # è¨­å®šé é¢
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ DarkModeSettings.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ReaderSettings.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ AdBlockSettings.tsx
â”‚   â”‚   â”‚   â””â”€â”€ CustomCSS.tsx
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ dark-mode-service.ts    # æš—è‰²æ¨¡å¼é‚è¼¯
â”‚   â”‚   â”œâ”€â”€ reader-service.ts       # é–±è®€æ¨¡å¼é‚è¼¯
â”‚   â”‚   â”œâ”€â”€ storage-service.ts      # è¨­å®šç®¡ç†
â”‚   â”‚   â””â”€â”€ translation-service.ts  # ç¿»è­¯æœå‹™
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ color-inverter.ts       # é¡è‰²åè½‰
â”‚   â”‚   â”œâ”€â”€ article-parser.ts       # æ–‡ç« è§£æ
â”‚   â”‚   â”œâ”€â”€ css-injector.ts         # CSS æ³¨å…¥
â”‚   â”‚   â””â”€â”€ dom-utils.ts            # DOM å·¥å…·
â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â”œâ”€â”€ dark-mode-themes/       # æš—è‰²ä¸»é¡Œ
â”‚   â”‚   â”œâ”€â”€ reader-themes/          # é–±è®€ä¸»é¡Œ
â”‚   â”‚   â””â”€â”€ filters.css             # å»£å‘Šéæ¿¾è¦å‰‡
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts
â””â”€â”€ tests/
```

## ğŸ’» æ ¸å¿ƒç¨‹å¼ç¢¼ç¯„ä¾‹

### æš—è‰²æ¨¡å¼å¯¦ä½œ

```typescript
// src/content/dark-mode.ts
export class DarkModeInjector {
  private observer: MutationObserver | null = null;
  private cssVariables: Map<string, string> = new Map();

  enable(options: DarkModeOptions): void {
    // æ³¨å…¥æš—è‰²æ¨¡å¼ CSS
    this.injectCSS(this.generateDarkModeCSS(options));

    // ç›£æ§ DOM è®ŠåŒ–
    this.observer = new MutationObserver(() => {
      this.applyDarkMode(options);
    });

    this.observer.observe(document.body, {
      childList: true,
      subtree: true
    });
  }

  private generateDarkModeCSS(options: DarkModeOptions): string {
    const { brightness, contrast, preserveImages } = options;

    return `
      html {
        filter: invert(${100 - brightness}%)
                contrast(${contrast}%)
                hue-rotate(180deg);
      }

      ${preserveImages ? `
        img, video, iframe, [style*="background-image"] {
          filter: invert(${brightness}%)
                  contrast(${100 / contrast * 100}%)
                  hue-rotate(-180deg);
        }
      ` : ''}

      * {
        background-color: inherit !important;
        border-color: inherit !important;
      }
    `;
  }

  private injectCSS(css: string): void {
    const style = document.createElement('style');
    style.id = 'dark-mode-styles';
    style.textContent = css;
    document.head.appendChild(style);
  }

  disable(): void {
    const style = document.getElementById('dark-mode-styles');
    if (style) {
      style.remove();
    }

    if (this.observer) {
      this.observer.disconnect();
    }
  }
}

interface DarkModeOptions {
  brightness: number;    // 0-100
  contrast: number;      // 0-200
  preserveImages: boolean;
  schedule?: {
    enabled: boolean;
    sunrise: string;
    sunset: string;
  };
}
```

### é–±è®€æ¨¡å¼å¯¦ä½œ

```typescript
// src/services/reader-service.ts
import { Readability } from '@mozilla/readability';

export class ReaderService {
  extractArticle(): Article | null {
    const documentClone = document.cloneNode(true) as Document;
    const reader = new Readability(documentClone);
    const article = reader.parse();

    if (!article) {
      return null;
    }

    return {
      title: article.title,
      content: article.content,
      textContent: article.textContent,
      length: article.length,
      excerpt: article.excerpt,
      byline: article.byline,
      siteName: article.siteName
    };
  }

  renderReaderMode(article: Article, theme: ReaderTheme): void {
    // å‰µå»ºé–±è®€æ¨¡å¼å®¹å™¨
    const readerContainer = this.createReaderContainer(theme);

    // æ¸²æŸ“æ–‡ç« å…§å®¹
    readerContainer.innerHTML = `
      <div class="reader-header">
        <h1>${article.title}</h1>
        ${article.byline ? `<p class="byline">${article.byline}</p>` : ''}
      </div>
      <div class="reader-content">
        ${article.content}
      </div>
    `;

    // éš±è—åŸå§‹é é¢
    document.body.style.display = 'none';

    // æ’å…¥é–±è®€æ¨¡å¼
    document.documentElement.appendChild(readerContainer);
  }

  private createReaderContainer(theme: ReaderTheme): HTMLElement {
    const container = document.createElement('div');
    container.id = 'reader-mode-container';
    container.className = `theme-${theme.name}`;

    // æ‡‰ç”¨ä¸»é¡Œæ¨£å¼
    container.style.cssText = `
      max-width: ${theme.maxWidth}px;
      font-size: ${theme.fontSize}px;
      font-family: ${theme.fontFamily};
      line-height: ${theme.lineHeight};
      color: ${theme.textColor};
      background-color: ${theme.backgroundColor};
      padding: ${theme.padding}px;
      margin: 0 auto;
    `;

    return container;
  }

  exitReaderMode(): void {
    const container = document.getElementById('reader-mode-container');
    if (container) {
      container.remove();
    }
    document.body.style.display = '';
  }
}

interface Article {
  title: string;
  content: string;
  textContent: string;
  length: number;
  excerpt: string;
  byline: string | null;
  siteName: string | null;
}

interface ReaderTheme {
  name: string;
  maxWidth: number;
  fontSize: number;
  fontFamily: string;
  lineHeight: number;
  textColor: string;
  backgroundColor: string;
  padding: number;
}
```

### æ™ºèƒ½å»£å‘Šæ””æˆª

```typescript
// src/content/ad-blocker.ts
export class AdBlocker {
  private blockedElements: Set<Element> = new Set();

  // å¸¸è¦‹å»£å‘Šé¸æ“‡å™¨
  private adSelectors = [
    '[class*="ad-"]',
    '[id*="ad-"]',
    '[class*="advertisement"]',
    '.sponsored',
    '[data-ad-slot]',
    'iframe[src*="doubleclick"]',
    'iframe[src*="googlesyndication"]'
  ];

  init(): void {
    this.blockAds();
    this.observeNewAds();
    this.removeCookieBanners();
  }

  private blockAds(): void {
    const selector = this.adSelectors.join(', ');
    const adElements = document.querySelectorAll(selector);

    adElements.forEach(element => {
      this.hideElement(element);
    });
  }

  private hideElement(element: Element): void {
    (element as HTMLElement).style.display = 'none';
    this.blockedElements.add(element);
  }

  private observeNewAds(): void {
    const observer = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
        mutation.addedNodes.forEach((node) => {
          if (node.nodeType === Node.ELEMENT_NODE) {
            const element = node as Element;

            // æª¢æŸ¥æ˜¯å¦ç¬¦åˆå»£å‘Šé¸æ“‡å™¨
            if (this.isAdElement(element)) {
              this.hideElement(element);
            }

            // æª¢æŸ¥å­å…ƒç´ 
            const adChildren = element.querySelectorAll(
              this.adSelectors.join(', ')
            );
            adChildren.forEach(ad => this.hideElement(ad));
          }
        });
      });
    });

    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
  }

  private isAdElement(element: Element): boolean {
    return this.adSelectors.some(selector => {
      return element.matches(selector);
    });
  }

  private removeCookieBanners(): void {
    const cookieBannerSelectors = [
      '[class*="cookie"]',
      '[id*="cookie"]',
      '[class*="gdpr"]',
      '[class*="consent"]'
    ];

    setTimeout(() => {
      const banners = document.querySelectorAll(
        cookieBannerSelectors.join(', ')
      );
      banners.forEach(banner => this.hideElement(banner));
    }, 1000);
  }

  getBlockedCount(): number {
    return this.blockedElements.size;
  }
}
```

## ğŸ¤– AI åŠŸèƒ½æ•´åˆ

### AI æ™ºèƒ½é…è‰²å„ªåŒ–

```typescript
// src/services/ai-color-optimizer.ts
export class AIColorOptimizer {
  async optimizeDarkMode(pageColors: string[]): Promise<DarkTheme> {
    // ä½¿ç”¨ AI åˆ†æé é¢ä¸»è‰²èª¿ï¼Œç”Ÿæˆæœ€ä½³æš—è‰²ä¸»é¡Œ
    const response = await fetch('https://api.openai.com/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${API_KEY}`
      },
      body: JSON.stringify({
        model: 'gpt-4',
        messages: [
          {
            role: 'system',
            content: 'You are a color expert. Generate optimal dark mode color schemes.'
          },
          {
            role: 'user',
            content: `Generate a dark mode theme for these colors: ${pageColors.join(', ')}`
          }
        ]
      })
    });

    const data = await response.json();
    return this.parseDarkTheme(data.choices[0].message.content);
  }
}
```

## ğŸ¨ UI è¨­è¨ˆ

### å½ˆå‡ºè¦–çª—åŠŸèƒ½
- å¿«é€Ÿåˆ‡æ›é–‹é—œ
- äº®åº¦/å°æ¯”åº¦æ»‘æ¡¿
- é è¨­ä¸»é¡Œé¸æ“‡
- ç•¶å‰é é¢è¨­å®š

### è¨­å®šé é¢
- è©³ç´°åŠŸèƒ½è¨­å®š
- è‡ªè¨‚ CSS ç·¨è¼¯å™¨
- æ¨£å¼ç¯„æœ¬åº«
- åŒ¯å…¥/åŒ¯å‡ºè¨­å®š

## ğŸ§ª é–‹ç™¼è·¯ç·šåœ–

### Phase 1: åŸºç¤åŠŸèƒ½ âœ…
- [x] å°ˆæ¡ˆè¨­ç½®
- [ ] åŸºæœ¬æš—è‰²æ¨¡å¼
- [ ] ç°¡å–®é–±è®€æ¨¡å¼
- [ ] å­—é«”èª¿æ•´

### Phase 2: é€²éšåŠŸèƒ½
- [ ] æ™ºèƒ½æš—è‰²æ¨¡å¼
- [ ] é€²éšé–±è®€æ¨¡å¼ï¼ˆTTSï¼‰
- [ ] å»£å‘Šæ””æˆª
- [ ] è‡ªè¨‚ CSS

### Phase 3: AI æ•´åˆ
- [ ] AI é…è‰²å„ªåŒ–
- [ ] æ™ºèƒ½å…§å®¹è­˜åˆ¥
- [ ] AI ç¿»è­¯åŠŸèƒ½

### Phase 4: å®Œå–„èˆ‡ç™¼å¸ƒ
- [ ] æ•ˆèƒ½å„ªåŒ–
- [ ] æ›´å¤šç¶²ç«™ç›¸å®¹æ€§
- [ ] é›²ç«¯åŒæ­¥è¨­å®š
- [ ] ç™¼å¸ƒåˆ°å•†åº—

## ğŸ“š ä½¿ç”¨ AI å·¥å…·é–‹ç™¼

### AI é–‹ç™¼å·¥ä½œæµç¨‹
1. AI ç”Ÿæˆ CSS æ¿¾é¡æ•ˆæœ
2. AI å„ªåŒ–é¡è‰²è½‰æ›æ¼”ç®—æ³•
3. AI å”åŠ©æ–‡ç« å…§å®¹æå–
4. AI ç”Ÿæˆå¤šèªè¨€ç¿»è­¯

## âš™ï¸ é è¨­ä¸»é¡Œ

### æš—è‰²ä¸»é¡Œ
- **æ·±é»‘** - OLED å‹å–„
- **æŸ”å’Œç°** - é™ä½å°æ¯”
- **æ·±è—** - è­·çœ¼æ¨¡å¼
- **è‡ªè¨‚** - è‡ªè¨‚é¡è‰²

### é–±è®€ä¸»é¡Œ
- **ç¶“å…¸** - ç™½åº•é»‘å­—
- **è­·çœ¼** - æ·ºé»ƒåº•
- **å¤œé–“** - æ·±ç°åº•
- **ç´™è³ª** - ä»¿çœŸç´™å¼µ

## ğŸ”’ éš±ç§èˆ‡å®‰å…¨

- âœ… æ‰€æœ‰è™•ç†å®Œå…¨æœ¬åœ°åŸ·è¡Œ
- âœ… ä¸æ”¶é›†ç€è¦½æ­·å²
- âœ… è¨­å®šå„²å­˜æ–¼æœ¬åœ°
- âœ… å¯é¸æ“‡æ€§å•Ÿç”¨åŠŸèƒ½

## ğŸ¤ è²¢ç»æŒ‡å—

æ­¡è¿è²¢ç»æ–°åŠŸèƒ½å’Œæ”¹é€²ï¼

å»ºè­°åŠŸèƒ½ï¼š
- å½±ç‰‡æ’­æ”¾å¢å¼·
- åœ–ç‰‡æ‡¶è¼‰å…¥
- é é¢æˆªåœ–å·¥å…·
- PDF é–±è®€æ¨¡å¼

## ğŸ“„ æˆæ¬Š

MIT License

---

**è®“æ¯å€‹ç¶²é éƒ½æˆç‚ºæ‚¨çš„å°ˆå±¬é«”é©—** ğŸš€

æœ€å¾Œæ›´æ–°: 2025-11-16
ç‹€æ…‹: ğŸš§ é–‹ç™¼ä¸­
