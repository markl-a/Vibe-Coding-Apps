<Window x:Class="WpfNotesApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="ðŸ“ ç­†è¨˜æ‡‰ç”¨ - WPF Notes App" Height="600" Width="900"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>

        <Style TargetType="Button">
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style x:Key="NoteListItem" TargetType="ListBoxItem">
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Margin" Value="2,1"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#0078D4"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E8F4FD"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- å·¦å´é‚Šæ¬„ - ç­†è¨˜åˆ—è¡¨ -->
        <Border Grid.Column="0" Background="#F5F5F5" BorderBrush="#E0E0E0" BorderThickness="0,0,1,0">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- æ¨™é¡Œ -->
                <TextBlock Grid.Row="0" Text="ðŸ“ æˆ‘çš„ç­†è¨˜"
                          FontSize="22" FontWeight="Bold"
                          Foreground="#333333"
                          Margin="5,10,5,15"/>

                <!-- æœå°‹æ¡† -->
                <Border Grid.Row="1" Background="White"
                       BorderBrush="#CCCCCC" BorderThickness="1"
                       CornerRadius="4" Margin="0,0,0,10">
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                            BorderThickness="0"
                            Padding="10,8">
                        <TextBox.Style>
                            <Style TargetType="TextBox">
                                <Setter Property="Foreground" Value="#333333"/>
                                <Style.Triggers>
                                    <Trigger Property="Text" Value="">
                                        <Setter Property="Background">
                                            <Setter.Value>
                                                <VisualBrush Stretch="None" AlignmentX="Left">
                                                    <VisualBrush.Visual>
                                                        <TextBlock Text="ðŸ” æœå°‹ç­†è¨˜..."
                                                                  Foreground="#999999"
                                                                  Margin="5,0,0,0"/>
                                                    </VisualBrush.Visual>
                                                </VisualBrush>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>
                </Border>

                <!-- çµ±è¨ˆè³‡è¨Š -->
                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="5,0,5,10">
                    <TextBlock Text="{Binding FilteredNotes.Count, StringFormat='å…± {0} å€‹ç­†è¨˜'}"
                              FontSize="12" Foreground="#666666"/>
                </StackPanel>

                <!-- ç­†è¨˜åˆ—è¡¨ -->
                <Border Grid.Row="3" Background="White"
                       BorderBrush="#E0E0E0" BorderThickness="1"
                       CornerRadius="4">
                    <ListBox ItemsSource="{Binding FilteredNotes}"
                            SelectedItem="{Binding SelectedNote}"
                            ItemContainerStyle="{StaticResource NoteListItem}"
                            BorderThickness="0"
                            ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Text="{Binding Title}"
                                              FontWeight="Bold"
                                              FontSize="14"
                                              TextTrimming="CharacterEllipsis"
                                              Margin="0,0,0,4"/>

                                    <TextBlock Grid.Row="1" Text="{Binding Content}"
                                              FontSize="12"
                                              Opacity="0.7"
                                              TextTrimming="CharacterEllipsis"
                                              MaxHeight="36"
                                              TextWrapping="Wrap"
                                              Margin="0,0,0,4"/>

                                    <TextBlock Grid.Row="2"
                                              Text="{Binding ModifiedAt, StringFormat='yyyy/MM/dd HH:mm'}"
                                              FontSize="11"
                                              Opacity="0.6"/>
                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Border>

                <!-- æ–°å¢žæŒ‰éˆ• -->
                <Button Grid.Row="4"
                       Content="âž• æ–°å¢žç­†è¨˜"
                       Background="#0078D4"
                       Foreground="White"
                       FontWeight="Bold"
                       Height="40"
                       Margin="0,10,0,0"
                       Command="{Binding AddNoteCommand}">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                               CornerRadius="4"
                                               Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#005A9E"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Border>

        <!-- å³å´å…§å®¹å€ - ç­†è¨˜ç·¨è¼¯ -->
        <Grid Grid.Column="1" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- æœ‰é¸æ“‡ç­†è¨˜æ™‚é¡¯ç¤º -->
            <Grid Visibility="{Binding SelectedNote, Converter={StaticResource BoolToVisibility}}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- ç­†è¨˜æ¨™é¡Œ -->
                <TextBox Grid.Row="0"
                        Text="{Binding SelectedNote.Title, UpdateSourceTrigger=PropertyChanged}"
                        FontSize="28"
                        FontWeight="Bold"
                        BorderThickness="0,0,0,2"
                        BorderBrush="#E0E0E0"
                        Padding="0,0,0,10"
                        Margin="0,0,0,15"
                        Background="Transparent">
                    <TextBox.Style>
                        <Style TargetType="TextBox">
                            <Style.Triggers>
                                <Trigger Property="Text" Value="">
                                    <Setter Property="Background">
                                        <Setter.Value>
                                            <VisualBrush Stretch="None" AlignmentX="Left">
                                                <VisualBrush.Visual>
                                                    <TextBlock Text="ç­†è¨˜æ¨™é¡Œ..."
                                                              Foreground="#CCCCCC"
                                                              FontSize="28"
                                                              FontWeight="Bold"/>
                                                </VisualBrush.Visual>
                                            </VisualBrush>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TextBox.Style>
                </TextBox>

                <!-- ç­†è¨˜è³‡è¨Š -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
                    <TextBlock Text="ðŸ“…" FontSize="14" Margin="0,0,5,0"/>
                    <TextBlock Text="{Binding SelectedNote.CreatedAt, StringFormat='å»ºç«‹: {0:yyyy/MM/dd HH:mm}'}"
                              FontSize="13" Foreground="#666666" Margin="0,0,15,0"/>
                    <TextBlock Text="ðŸ”„" FontSize="14" Margin="0,0,5,0"/>
                    <TextBlock Text="{Binding SelectedNote.ModifiedAt, StringFormat='ä¿®æ”¹: {0:yyyy/MM/dd HH:mm}'}"
                              FontSize="13" Foreground="#666666" Margin="0,0,15,0"/>
                    <TextBlock Text="ðŸ“‚" FontSize="14" Margin="0,0,5,0"/>
                    <TextBlock Text="{Binding SelectedNote.Category}"
                              FontSize="13" Foreground="#666666"/>
                </StackPanel>

                <!-- ç­†è¨˜å…§å®¹ -->
                <Border Grid.Row="2" Background="White"
                       BorderBrush="#E0E0E0" BorderThickness="1"
                       CornerRadius="4">
                    <TextBox Text="{Binding SelectedNote.Content, UpdateSourceTrigger=PropertyChanged}"
                            AcceptsReturn="True"
                            TextWrapping="Wrap"
                            VerticalScrollBarVisibility="Auto"
                            FontFamily="Consolas, Courier New, monospace"
                            FontSize="14"
                            LineHeight="22"
                            Padding="15"
                            BorderThickness="0"
                            VerticalContentAlignment="Top"/>
                </Border>

                <!-- æ“ä½œæŒ‰éˆ• -->
                <StackPanel Grid.Row="3" Orientation="Horizontal"
                           HorizontalAlignment="Right"
                           Margin="0,15,0,0">
                    <Button Content="ðŸ’¾ å„²å­˜" Width="100"
                           Command="{Binding SaveNoteCommand}"
                           Background="#28A745"
                           Foreground="White">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}"
                                                   CornerRadius="4"
                                                   Padding="15,8">
                                                <ContentPresenter HorizontalAlignment="Center"
                                                                VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#218838"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    <Button Content="ðŸ—‘ï¸ åˆªé™¤" Width="100"
                           Command="{Binding DeleteNoteCommand}"
                           CommandParameter="{Binding SelectedNote}"
                           Background="#DC3545"
                           Foreground="White">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}"
                                                   CornerRadius="4"
                                                   Padding="15,8">
                                                <ContentPresenter HorizontalAlignment="Center"
                                                                VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#C82333"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- ç©ºç‹€æ…‹æç¤º -->
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center"
                       Visibility="{Binding SelectedNote, Converter={StaticResource BoolToVisibility}}">
                <StackPanel.Style>
                    <Style TargetType="StackPanel">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding SelectedNote}" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding SelectedNote}" Value="{x:Null}">
                                <DataTrigger.Value>
                                    <Binding Path="SelectedNote">
                                        <Binding.TargetNullValue>
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </Binding.TargetNullValue>
                                    </Binding>
                                </DataTrigger.Value>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </StackPanel.Style>
                <TextBlock Text="ðŸ“" FontSize="96" HorizontalAlignment="Center"
                          Foreground="#E0E0E0" Margin="0,0,0,20"/>
                <TextBlock Text="é¸æ“‡ä¸€å€‹ç­†è¨˜æˆ–å»ºç«‹æ–°ç­†è¨˜"
                          FontSize="18" Foreground="#999999"
                          HorizontalAlignment="Center"/>
                <TextBlock Text="ä½¿ç”¨å·¦å´çš„ã€Œâž• æ–°å¢žç­†è¨˜ã€æŒ‰éˆ•é–‹å§‹"
                          FontSize="14" Foreground="#CCCCCC"
                          HorizontalAlignment="Center"
                          Margin="0,10,0,0"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
