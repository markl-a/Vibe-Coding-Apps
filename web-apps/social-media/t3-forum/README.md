# T3 Stack è«–å£‡ç³»çµ±

ä½¿ç”¨ T3 Stack æ‰“é€ çš„ç¾ä»£åŒ–è«–å£‡å¹³å° - å®Œæ•´å‹åˆ¥å®‰å…¨ã€é«˜æ•ˆèƒ½ã€æ˜“æ“´å±•ã€‚

## ä»€éº¼æ˜¯ T3 Stackï¼Ÿ

T3 Stack æ˜¯ç”± Theo Browne æ¨å»£çš„å®Œæ•´ TypeScript æŠ€è¡“æ£§ï¼Œæä¾›ç«¯åˆ°ç«¯çš„å‹åˆ¥å®‰å…¨å’Œæœ€ä½³é–‹ç™¼é«”é©—ã€‚

## åŠŸèƒ½ç‰¹è‰²

- âœ¨ **å®Œæ•´å‹åˆ¥å®‰å…¨** - å¾è³‡æ–™åº«åˆ° UI çš„ç«¯åˆ°ç«¯å‹åˆ¥å®‰å…¨
- âš¡ **é«˜æ•ˆèƒ½** - Next.js 14 SSR + tRPC é«˜æ•ˆ API
- ğŸ” **å®‰å…¨èªè­‰** - NextAuth.js å®Œæ•´èªè­‰ç³»çµ±
- ğŸ’¬ **è¨è«–ç³»çµ±** - ä¸»é¡Œç™¼å¸ƒã€ç•™è¨€ã€å·¢ç‹€å›è¦†
- ğŸ† **è²æœ›ç³»çµ±** - ç”¨æˆ¶è²æœ›ã€å¾½ç« ã€æ’è¡Œæ¦œ
- ğŸ“Š **æŠ•ç¥¨æ©Ÿåˆ¶** - è®š/è¸©æŠ•ç¥¨ã€æœ€ä½³è§£ç­”
- ğŸ·ï¸ **æ¨™ç±¤åˆ†é¡** - è«–å£‡åˆ†é¡ã€æ–‡ç« æ¨™ç±¤
- ğŸ” **æœå°‹åŠŸèƒ½** - å…¨æ–‡æœå°‹æ–‡ç« èˆ‡ç”¨æˆ¶
- ğŸ“± **éŸ¿æ‡‰å¼è¨­è¨ˆ** - å®Œç¾æ”¯æ´å„ç¨®è£ç½®
- ğŸ¨ **Markdown ç·¨è¼¯** - æ”¯æ´ Markdown èˆ‡ç¨‹å¼ç¢¼é«˜äº®

## æ ¸å¿ƒæŠ€è¡“

### T3 Stack çµ„æˆ

1. **Next.js 14** - React æ¡†æ¶
   - App Router / Pages Router
   - Server-Side Rendering
   - Static Site Generation
   - Image Optimization

2. **tRPC** - Type-Safe API
   - ç«¯åˆ°ç«¯å‹åˆ¥å®‰å…¨
   - ç„¡éœ€ Schema å®šç¾©
   - è‡ªå‹•å‹åˆ¥æ¨æ–·
   - React Query æ•´åˆ

3. **Prisma** - è³‡æ–™åº« ORM
   - å‹åˆ¥å®‰å…¨çš„è³‡æ–™åº«æ“ä½œ
   - è‡ªå‹•é·ç§»
   - Schema ç®¡ç†
   - Prisma Studio

4. **NextAuth.js** - èªè­‰ç³»çµ±
   - å¤šç¨®ç™»å…¥æ–¹å¼
   - Session ç®¡ç†
   - JWT Token
   - OAuth æ”¯æ´

5. **Tailwind CSS** - æ¨£å¼æ¡†æ¶
   - Utility-First CSS
   - éŸ¿æ‡‰å¼è¨­è¨ˆ
   - æ·±è‰²æ¨¡å¼æ”¯æ´

## æ ¸å¿ƒåŠŸèƒ½

### 1. ç”¨æˆ¶ç³»çµ±
- Email/å¯†ç¢¼è¨»å†Šç™»å…¥
- OAuth ç¤¾äº¤ç™»å…¥ï¼ˆGoogle, GitHub ç­‰ï¼‰
- å€‹äººè³‡æ–™é é¢
- è²æœ›èˆ‡ç­‰ç´šç³»çµ±
- å¾½ç« çå‹µ
- æ´»å‹•æ­·å²

### 2. è«–å£‡åˆ†é¡
- å¤šå±¤ç´šåˆ†é¡
- è‡ªè¨‚åˆ†é¡åœ–ç¤ºèˆ‡é¡è‰²
- ç‰ˆä¸»ç®¡ç†
- åˆ†é¡æè¿°èˆ‡è¦å‰‡

### 3. æ–‡ç« ç™¼å¸ƒ
- Markdown ç·¨è¼¯å™¨
- ç¨‹å¼ç¢¼é«˜äº®é¡¯ç¤º
- åœ–ç‰‡ä¸Šå‚³
- æ¨™ç±¤ç³»çµ±
- è‰ç¨¿å„²å­˜
- æ–‡ç« ç½®é ‚/é–å®š

### 4. ç•™è¨€ç³»çµ±
- å·¢ç‹€å›è¦†ï¼ˆç„¡é™å±¤ç´šï¼‰
- @æåŠç”¨æˆ¶
- å¼•ç”¨å›è¦†
- ç•™è¨€ç·¨è¼¯èˆ‡åˆªé™¤
- æœ€ä½³è§£ç­”æ¨™è¨˜

### 5. æŠ•ç¥¨æ©Ÿåˆ¶
- è®š/è¸©æŠ•ç¥¨
- è²æœ›è¨ˆç®—
- æŠ•ç¥¨æ­·å²
- é˜²æ­¢é‡è¤‡æŠ•ç¥¨

### 6. æœå°‹åŠŸèƒ½
- æ–‡ç« å…¨æ–‡æœå°‹
- ç”¨æˆ¶æœå°‹
- æ¨™ç±¤æœå°‹
- é€²éšç¯©é¸

### 7. é€šçŸ¥ç³»çµ±
- å›è¦†é€šçŸ¥
- @æåŠé€šçŸ¥
- ç§è¨Šé€šçŸ¥
- ç³»çµ±å…¬å‘Š

### 8. ç®¡ç†åŠŸèƒ½
- ç®¡ç†å“¡æ¬Šé™
- ç‰ˆä¸»ç³»çµ±
- å…§å®¹å¯©æ ¸
- ç”¨æˆ¶å°ç¦
- çµ±è¨ˆåˆ†æ

## å¿«é€Ÿé–‹å§‹

### å‰ç½®éœ€æ±‚

- Node.js 18+
- PostgreSQL è³‡æ–™åº«
- pnpm (æ¨è–¦) æˆ– npm

### å®‰è£ä¾è³´

```bash
pnpm install
# æˆ–
npm install
```

### ç’°å¢ƒè®Šæ•¸è¨­å®š

å»ºç«‹ `.env` æª”æ¡ˆï¼š

```bash
# è³‡æ–™åº«
DATABASE_URL="postgresql://user:password@localhost:5432/t3_forum"

# NextAuth
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret-key-here"

# OAuth Providersï¼ˆå¯é¸ï¼‰
GOOGLE_CLIENT_ID="your-google-client-id"
GOOGLE_CLIENT_SECRET="your-google-client-secret"

GITHUB_CLIENT_ID="your-github-client-id"
GITHUB_CLIENT_SECRET="your-github-client-secret"
```

### è³‡æ–™åº«è¨­ç½®

```bash
# ç”¢ç”Ÿ Prisma Client
pnpm prisma generate

# åŸ·è¡Œè³‡æ–™åº«é·ç§»
pnpm prisma migrate dev

# å¡«å……ç¨®å­è³‡æ–™ï¼ˆå¯é¸ï¼‰
pnpm prisma db seed

# é–‹å•Ÿ Prisma Studioï¼ˆè³‡æ–™åº«è¦–è¦ºåŒ–ç®¡ç†ï¼‰
pnpm prisma studio
```

### é–‹ç™¼æ¨¡å¼

```bash
pnpm dev
```

é–‹å•Ÿç€è¦½å™¨è¨ªå• [http://localhost:3000](http://localhost:3000)

### å»ºç½®ç”Ÿç”¢ç‰ˆæœ¬

```bash
pnpm build
pnpm start
```

## å°ˆæ¡ˆçµæ§‹

```
t3-forum/
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma          # Prisma Schemaï¼ˆè³‡æ–™åº«çµæ§‹ï¼‰
â”‚   â””â”€â”€ migrations/            # è³‡æ–™åº«é·ç§»è¨˜éŒ„
â”œâ”€â”€ public/                    # éœæ…‹è³‡æº
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ pages/                 # Next.js Pages
â”‚   â”‚   â”œâ”€â”€ _app.tsx          # App å…¥å£
â”‚   â”‚   â”œâ”€â”€ index.tsx         # é¦–é 
â”‚   â”‚   â”œâ”€â”€ forum/            # è«–å£‡é é¢
â”‚   â”‚   â””â”€â”€ api/
â”‚   â”‚       â”œâ”€â”€ auth/         # NextAuth API
â”‚   â”‚       â””â”€â”€ trpc/         # tRPC API ç«¯é»
â”‚   â”œâ”€â”€ components/           # React çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ forum/
â”‚   â”‚   â”‚   â”œâ”€â”€ PostCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CommentList.tsx
â”‚   â”‚   â”‚   â””â”€â”€ PostEditor.tsx
â”‚   â”‚   â””â”€â”€ ui/
â”‚   â”‚       â”œâ”€â”€ Button.tsx
â”‚   â”‚       â””â”€â”€ Modal.tsx
â”‚   â”œâ”€â”€ server/               # å¾Œç«¯é‚è¼¯
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ root.ts      # tRPC Root Router
â”‚   â”‚   â”‚   â”œâ”€â”€ trpc.ts      # tRPC è¨­å®š
â”‚   â”‚   â”‚   â””â”€â”€ routers/     # tRPC Routers
â”‚   â”‚   â”‚       â”œâ”€â”€ post.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ comment.ts
â”‚   â”‚   â”‚       â””â”€â”€ user.ts
â”‚   â”‚   â”œâ”€â”€ auth.ts          # NextAuth è¨­å®š
â”‚   â”‚   â””â”€â”€ db.ts            # Prisma Client
â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â””â”€â”€ globals.css      # å…¨å±€æ¨£å¼
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ api.ts           # tRPC Client
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tailwind.config.ts
â””â”€â”€ next.config.js
```

## tRPC ä½¿ç”¨ç¯„ä¾‹

### å®šç¾© Router

```typescript
// src/server/api/routers/post.ts
import { z } from "zod";
import { createTRPCRouter, publicProcedure, protectedProcedure } from "../trpc";

export const postRouter = createTRPCRouter({
  getAll: publicProcedure
    .input(z.object({
      limit: z.number().min(1).max(100).default(10),
    }))
    .query(async ({ ctx, input }) => {
      return ctx.db.post.findMany({
        take: input.limit,
        orderBy: { createdAt: 'desc' },
      });
    }),

  create: protectedProcedure
    .input(z.object({
      title: z.string().min(5).max(200),
      content: z.string().min(10),
    }))
    .mutation(async ({ ctx, input }) => {
      return ctx.db.post.create({
        data: {
          ...input,
          authorId: ctx.session.user.id,
        },
      });
    }),
});
```

### åœ¨çµ„ä»¶ä¸­ä½¿ç”¨

```typescript
import { api } from "@/utils/api";

function PostList() {
  // æŸ¥è©¢
  const { data, isLoading } = api.post.getAll.useQuery({ limit: 10 });

  // Mutation
  const createPost = api.post.create.useMutation({
    onSuccess: () => {
      // åˆ·æ–°è³‡æ–™
      utils.post.getAll.invalidate();
    },
  });

  const handleSubmit = (title: string, content: string) => {
    createPost.mutate({ title, content });
  };

  if (isLoading) return <div>è¼‰å…¥ä¸­...</div>;

  return (
    <div>
      {data?.map(post => (
        <PostCard key={post.id} post={post} />
      ))}
    </div>
  );
}
```

## Prisma Schema ç¯„ä¾‹

```prisma
model User {
  id         String    @id @default(cuid())
  email      String    @unique
  name       String?
  reputation Int       @default(0)
  posts      Post[]
  comments   Comment[]
  votes      Vote[]
  createdAt  DateTime  @default(now())
}

model Post {
  id        String    @id @default(cuid())
  title     String
  content   String
  author    User      @relation(fields: [authorId], references: [id])
  authorId  String
  comments  Comment[]
  votes     Vote[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Comment {
  id       String    @id @default(cuid())
  content  String
  author   User      @relation(fields: [authorId], references: [id])
  authorId String
  post     Post      @relation(fields: [postId], references: [id])
  postId   String
  parent   Comment?  @relation("Replies", fields: [parentId], references: [id])
  parentId String?
  replies  Comment[] @relation("Replies")
}
```

## èªè­‰è¨­ç½®

### NextAuth.js é…ç½®

```typescript
// src/server/auth.ts
import { PrismaAdapter } from "@next-auth/prisma-adapter";
import GoogleProvider from "next-auth/providers/google";
import GitHubProvider from "next-auth/providers/github";

export const authOptions: NextAuthOptions = {
  adapter: PrismaAdapter(db),
  providers: [
    GoogleProvider({
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    }),
    GitHubProvider({
      clientId: process.env.GITHUB_CLIENT_ID!,
      clientSecret: process.env.GITHUB_CLIENT_SECRET!,
    }),
  ],
  callbacks: {
    session: ({ session, user }) => ({
      ...session,
      user: {
        ...session.user,
        id: user.id,
      },
    }),
  },
};
```

### åœ¨çµ„ä»¶ä¸­ä½¿ç”¨

```typescript
import { useSession, signIn, signOut } from "next-auth/react";

function AuthButton() {
  const { data: session } = useSession();

  if (session) {
    return (
      <>
        <p>å·²ç™»å…¥ç‚º {session.user?.email}</p>
        <button onClick={() => signOut()}>ç™»å‡º</button>
      </>
    );
  }

  return <button onClick={() => signIn()}>ç™»å…¥</button>;
}
```

## éƒ¨ç½²

### Vercel éƒ¨ç½²ï¼ˆæ¨è–¦ï¼‰

T3 Stack å°ˆç‚º Vercel å„ªåŒ–ï¼š

```bash
# å®‰è£ Vercel CLI
npm i -g vercel

# éƒ¨ç½²
vercel
```

æˆ–ç›´æ¥åœ¨ Vercel ç¶²ç«™åŒ¯å…¥ GitHub repositoryã€‚

### ç’°å¢ƒè®Šæ•¸è¨­å®š

åœ¨ Vercel Dashboard è¨­å®šä»¥ä¸‹ç’°å¢ƒè®Šæ•¸ï¼š
- `DATABASE_URL`
- `NEXTAUTH_URL`
- `NEXTAUTH_SECRET`
- OAuth Provider æ†‘è­‰

### Railway / Render éƒ¨ç½²

1. å»ºç«‹ PostgreSQL è³‡æ–™åº«
2. è¨­å®šç’°å¢ƒè®Šæ•¸
3. é€£æ¥ GitHub repository
4. è‡ªå‹•éƒ¨ç½²

## æ•ˆèƒ½å„ªåŒ–

- âœ… React Query å¿«å–ç®¡ç†
- âœ… tRPC æ‰¹æ¬¡è«‹æ±‚
- âœ… Prisma æŸ¥è©¢å„ªåŒ–
- âœ… Next.js Image å„ªåŒ–
- âœ… ç¨‹å¼ç¢¼åˆ†å‰²ï¼ˆCode Splittingï¼‰
- âœ… ISRï¼ˆIncremental Static Regenerationï¼‰

## å®‰å…¨æ€§

- ğŸ”’ tRPC å‹åˆ¥å®‰å…¨
- ğŸ”’ Prisma é˜² SQL Injection
- ğŸ”’ NextAuth.js Session ç®¡ç†
- ğŸ”’ CSRF ä¿è­·
- ğŸ”’ XSS é˜²è­·
- ğŸ”’ Rate Limiting
- ğŸ”’ å…§å®¹å¯©æ ¸

## æ¸¬è©¦

```bash
# å–®å…ƒæ¸¬è©¦
pnpm test

# E2E æ¸¬è©¦
pnpm test:e2e

# å‹åˆ¥æª¢æŸ¥
pnpm type-check
```

## é€²éšåŠŸèƒ½å»ºè­°

- ğŸ“Š å³æ™‚é€šçŸ¥ï¼ˆWebSocketï¼‰
- ğŸ” Elasticsearch å…¨æ–‡æœå°‹
- ğŸ“± PWA æ”¯æ´
- ğŸŒ åœ‹éš›åŒ–ï¼ˆi18nï¼‰
- ğŸ¨ ä¸»é¡Œåˆ‡æ›
- ğŸ“ˆ çµ±è¨ˆåˆ†æå„€è¡¨æ¿
- ğŸ¤– AI å…§å®¹æ¨è–¦
- ğŸ’° ä»˜è²»åŠŸèƒ½ï¼ˆStripeï¼‰

## T3 Stack å„ªå‹¢

### 1. å®Œæ•´å‹åˆ¥å®‰å…¨
- å¾è³‡æ–™åº«åˆ° UI çš„ç«¯åˆ°ç«¯å‹åˆ¥æ¨æ–·
- ç„¡éœ€æ‰‹å‹•å®šç¾© API Schema
- ç·¨è­¯æ™‚éŒ¯èª¤æª¢æŸ¥

### 2. é–‹ç™¼é«”é©—
- è‡ªå‹•è£œå…¨ï¼ˆIntelliSenseï¼‰
- å‹åˆ¥æ¨æ–·
- é‡æ§‹å®‰å…¨
- ç†±æ¨¡çµ„æ›¿æ›ï¼ˆHMRï¼‰

### 3. æ•ˆèƒ½
- tRPC æ‰¹æ¬¡è«‹æ±‚
- React Query æ™ºæ…§å¿«å–
- Next.js SSR/SSG
- Prisma æŸ¥è©¢å„ªåŒ–

### 4. å¯ç¶­è­·æ€§
- æ¸…æ™°çš„å°ˆæ¡ˆçµæ§‹
- å‹åˆ¥å®‰å…¨æ¸›å°‘ Bug
- æ˜“æ–¼æ¸¬è©¦
- æ–‡æª”å®Œå–„

## å¸¸è¦‹å•é¡Œ

### Q: tRPC vs REST vs GraphQLï¼Ÿ
A: tRPC æä¾› REST çš„ç°¡å–®æ€§ + GraphQL çš„å‹åˆ¥å®‰å…¨ï¼Œä¸”ç„¡éœ€é¡å¤–çš„ Schema å®šç¾©ã€‚

### Q: ç‚ºä»€éº¼é¸æ“‡ Prismaï¼Ÿ
A: Prisma æä¾›å‹åˆ¥å®‰å…¨çš„è³‡æ–™åº«æ“ä½œã€è‡ªå‹•é·ç§»ã€å„ªç§€çš„é–‹ç™¼é«”é©—ã€‚

### Q: å¯ä»¥ä½¿ç”¨å…¶ä»–è³‡æ–™åº«å—ï¼Ÿ
A: å¯ä»¥ï¼ŒPrisma æ”¯æ´ PostgreSQLã€MySQLã€SQLiteã€MongoDB ç­‰ã€‚

### Q: å¦‚ä½•æ–°å¢ API ç«¯é»ï¼Ÿ
A: åœ¨ `src/server/api/routers/` æ–°å¢ Routerï¼Œä¸¦åœ¨ `root.ts` è¨»å†Šã€‚

## å­¸ç¿’è³‡æº

- [T3 Stack å®˜æ–¹æ–‡æª”](https://create.t3.gg/)
- [tRPC æ–‡æª”](https://trpc.io/docs)
- [Prisma æ–‡æª”](https://www.prisma.io/docs)
- [Next.js æ–‡æª”](https://nextjs.org/docs)
- [NextAuth.js æ–‡æª”](https://next-auth.js.org/)

## ç¯„ä¾‹å°ˆæ¡ˆ

- [T3 Gallery](https://github.com/t3-oss/create-t3-app/tree/next/examples/create-t3-app)
- [Taxonomy](https://github.com/shadcn/taxonomy)
- [Ping.gg](https://github.com/pingdotgg)

## è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

## License

MIT License

---

**å»ºç«‹æ—¥æœŸ**: 2025-11-16
**ç‹€æ…‹**: âœ… å¯ç”¨
**ç‰ˆæœ¬**: 1.0.0
**æŠ€è¡“æ£§**: Next.js 14 + tRPC + Prisma + NextAuth.js + Tailwind CSS
