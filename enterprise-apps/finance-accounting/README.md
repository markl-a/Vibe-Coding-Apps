# è²¡å‹™æœƒè¨ˆç³»çµ± (Finance & Accounting System)
ğŸ¤– **AI-Driven | AI-Native** ğŸš€

è²¡å‹™æœƒè¨ˆç³»çµ±å¹«åŠ©ä¼æ¥­ç®¡ç†è²¡å‹™æ•¸æ“šã€ç”Ÿæˆè²¡å‹™å ±è¡¨ã€ç¢ºä¿åˆè¦æ€§ã€‚ä½¿ç”¨ AI è¼”åŠ©é–‹ç™¼å¯ä»¥å¿«é€Ÿå»ºç«‹åŠŸèƒ½å®Œæ•´ã€æº–ç¢ºå¯é çš„è²¡å‹™ç³»çµ±ã€‚

## âœ¨ **NEW: AI å¢å¼·åŠŸèƒ½å·²å®Œæˆï¼**

æ‰€æœ‰æ‡‰ç”¨ç¾å·²æ•´åˆå…ˆé€²çš„ AI åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ™ºèƒ½é æ¸¬ã€ç•°å¸¸æª¢æ¸¬ã€å„ªåŒ–å»ºè­°ç­‰ã€‚æŸ¥çœ‹ [IMPROVEMENTS.md](./IMPROVEMENTS.md) äº†è§£è©³æƒ…ã€‚

### ğŸ¯ å·²å®Œæˆçš„ AI åŠŸèƒ½
- âœ… **Invoice Generator**: æ™ºèƒ½åƒ¹æ ¼å»ºè­°ã€é …ç›®åˆ†é¡ã€å¥åº·åº¦åˆ†æ (10 é … AI åŠŸèƒ½)
- âœ… **Expense Tracker**: æ”¯å‡ºé æ¸¬ã€æ¨¡å¼è­˜åˆ¥ã€ç¯€çœå»ºè­° (7 é … AI åŠŸèƒ½)
- âœ… **Budget Planner**: æ™ºèƒ½é ç®—è¦åŠƒå’Œè²¡å‹™ç›®æ¨™ç®¡ç† (æ–°å¢æ‡‰ç”¨)

## ğŸ“‹ ç›®éŒ„

- [å¯ç”¨æ‡‰ç”¨ç¨‹å¼](#å¯ç”¨æ‡‰ç”¨ç¨‹å¼)
- [è²¡å‹™ç³»çµ±æ¦‚è¿°](#è²¡å‹™ç³»çµ±æ¦‚è¿°)
- [æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„](#æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„)
- [æŠ€è¡“æ¶æ§‹](#æŠ€è¡“æ¶æ§‹)
- [æ¨è–¦æŠ€è¡“æ£§](#æ¨è–¦æŠ€è¡“æ£§)
- [AI æ™ºèƒ½åŠŸèƒ½](#ai-æ™ºèƒ½åŠŸèƒ½)
- [å®‰å…¨èˆ‡åˆè¦](#å®‰å…¨èˆ‡åˆè¦)

---

## ğŸ“± å¯ç”¨æ‡‰ç”¨ç¨‹å¼

### 1. ğŸ“„ [Invoice Generator](./invoice-generator/) - ç™¼ç¥¨ç”Ÿæˆå™¨
å°ˆæ¥­ç™¼ç¥¨å‰µå»ºå’Œç®¡ç†ç³»çµ±ï¼Œæ”¯æ´ PDF ç”Ÿæˆã€‚
- âœ… **AI å¢å¼·**: æ™ºèƒ½åƒ¹æ ¼å»ºè­°ã€é …ç›®åˆ†é¡ã€å¥åº·åº¦åˆ†æ
- ğŸ”§ **åŠŸèƒ½**: å®¢æˆ¶ç®¡ç†ã€ç”¢å“ç›®éŒ„ã€è‡ªå‹•è¨ˆç®—ã€PDF å°å‡º
- ğŸ“Š **ç‹€æ…‹**: å®Œæ•´å¯¦ç¾ + AI åŠŸèƒ½æ¸¬è©¦é€šé

### 2. ğŸ’° [Expense Tracker](./expense-tracker/) - è²»ç”¨è¿½è¹¤å™¨
æ™ºèƒ½è²»ç”¨è¿½è¹¤å’Œåˆ†æç³»çµ±ï¼Œæ”¯æ´é ç®—ç®¡ç†ã€‚
- âœ… **AI å¢å¼·**: æ”¯å‡ºé æ¸¬ã€æ¨¡å¼è­˜åˆ¥ã€ç¯€çœå»ºè­°ã€ç¾é‡‘æµé æ¸¬
- ğŸ”§ **åŠŸèƒ½**: è²»ç”¨è¨˜éŒ„ã€åˆ†é¡ç®¡ç†ã€çµ±è¨ˆåˆ†æã€è¦–è¦ºåŒ–åœ–è¡¨
- ğŸ“Š **ç‹€æ…‹**: å®Œæ•´å¯¦ç¾ + AI åŠŸèƒ½æ¸¬è©¦é€šé

### 3. ğŸ“Š [Financial Dashboard](./financial-dashboard/) - è²¡å‹™å„€è¡¨æ¿
å³æ™‚è²¡å‹™æ•¸æ“šè¦–è¦ºåŒ–å’Œ KPI è¿½è¹¤ç³»çµ±ã€‚
- ğŸ”§ **åŠŸèƒ½**: æ”¶å…¥æ”¯å‡ºè¶¨å‹¢ã€åˆ©æ½¤åˆ†æã€ç¾é‡‘æµã€è²¡å‹™æ¯”ç‡
- ğŸ“Š **ç‹€æ…‹**: æ ¸å¿ƒåŠŸèƒ½å®Œæ•´

### 4. ğŸ§¾ [Receipt OCR](./receipt-ocr/) - ç™¼ç¥¨ OCR è­˜åˆ¥å™¨
è‡ªå‹•è­˜åˆ¥ç™¼ç¥¨ä¸¦æå–é—œéµè³‡è¨Šã€‚
- ğŸ”§ **åŠŸèƒ½**: OCR è­˜åˆ¥ã€è³‡è¨Šæå–ã€æ‰¹æ¬¡è™•ç†ã€æ­·å²è¨˜éŒ„
- ğŸ“Š **ç‹€æ…‹**: æ ¸å¿ƒåŠŸèƒ½å®Œæ•´

### 5. ğŸ¯ [Budget Planner](./budget-planner/) - é ç®—è¦åŠƒå™¨ â­ NEW
æ™ºèƒ½é ç®—è¦åŠƒå’Œè²¡å‹™ç›®æ¨™ç®¡ç†ç³»çµ±ã€‚
- âœ… **AI å¢å¼·**: æ™ºèƒ½é ç®—å»ºè­°ã€ç›®æ¨™è¿½è¹¤ã€å„ªåŒ–æ–¹æ¡ˆ
- ğŸ”§ **åŠŸèƒ½**: å¤šç¶­åº¦é ç®—ã€è²¡å‹™ç›®æ¨™ã€é ç®—ç¯„æœ¬ã€å¥åº·åº¦è©•åˆ†
- ğŸ“Š **ç‹€æ…‹**: æ–‡æª”å®Œæ•´

### å¿«é€Ÿå•Ÿå‹•
```bash
# é€²å…¥ä»»ä¸€æ‡‰ç”¨ç›®éŒ„
cd invoice-generator

# å®‰è£ä¾è³´
pip install -r requirements.txt

# å•Ÿå‹•æ‡‰ç”¨
streamlit run app.py
```

---

## ğŸ¯ è²¡å‹™ç³»çµ±æ¦‚è¿°

### æ ¸å¿ƒåŠŸèƒ½é ˜åŸŸ

- **ç¸½å¸³ç®¡ç† (General Ledger)**ï¼šæœƒè¨ˆç§‘ç›®ã€æ†‘è­‰ã€å¸³ç°¿
- **æ‡‰æ”¶å¸³æ¬¾ (AR)**ï¼šå®¢æˆ¶æ‡‰æ”¶ã€æ”¶æ¬¾ã€å¸³é½¡åˆ†æ
- **æ‡‰ä»˜å¸³æ¬¾ (AP)**ï¼šä¾›æ‡‰å•†æ‡‰ä»˜ã€ä»˜æ¬¾ã€å°å¸³
- **å›ºå®šè³‡ç”¢**ï¼šè³‡ç”¢ç™»è¨˜ã€æŠ˜èˆŠè¨ˆç®—ã€è™•ç½®
- **æˆæœ¬æœƒè¨ˆ**ï¼šæˆæœ¬ä¸­å¿ƒã€æˆæœ¬åˆ†æ”¤ã€æˆæœ¬åˆ†æ
- **è²¡å‹™å ±è¡¨**ï¼šè³‡ç”¢è² å‚µè¡¨ã€æç›Šè¡¨ã€ç¾é‡‘æµé‡è¡¨
- **é ç®—ç®¡ç†**ï¼šé ç®—ç·¨åˆ¶ã€é ç®—æ§åˆ¶ã€å·®ç•°åˆ†æ
- **ç¨…å‹™ç®¡ç†**ï¼šç¨…å‹™è¨ˆç®—ã€ç”³å ±ã€åˆè¦

---

## ğŸ§© æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„

### 1. ç¸½å¸³ç®¡ç†

#### æœƒè¨ˆç§‘ç›®è¡¨ (Chart of Accounts)
```typescript
interface Account {
  id: string;
  code: string; // ç§‘ç›®ä»£ç¢¼ å¦‚: 1001, 1002
  name: string;
  type: 'ASSET' | 'LIABILITY' | 'EQUITY' | 'REVENUE' | 'EXPENSE';
  subType: string; // å¦‚: 'CURRENT_ASSET', 'FIXED_ASSET'
  parentId?: string;
  level: number;
  balance: number;
  normalBalance: 'DEBIT' | 'CREDIT';
  isActive: boolean;
  isBankAccount: boolean;
  currency: string;
}
```

#### æœƒè¨ˆæ†‘è­‰ (Journal Entry)
```typescript
interface JournalEntry {
  id: string;
  journalNumber: string;
  date: Date;
  type: 'STANDARD' | 'ADJUSTING' | 'CLOSING' | 'REVERSING';
  status: 'DRAFT' | 'POSTED' | 'VOID';
  description: string;
  reference?: string; // å–®æ“šè™Ÿ

  lines: JournalLine[];

  totalDebit: number;
  totalCredit: number;

  createdBy: string;
  approvedBy?: string;
  postedAt?: Date;
}

interface JournalLine {
  id: string;
  accountId: string;
  account: Account;
  debit: number;
  credit: number;
  description: string;
  dimension1?: string; // éƒ¨é–€
  dimension2?: string; // å°ˆæ¡ˆ
  dimension3?: string; // æˆæœ¬ä¸­å¿ƒ
}
```

### 2. æ‡‰æ”¶å¸³æ¬¾ç®¡ç†

```typescript
interface Invoice {
  id: string;
  invoiceNumber: string;
  customerId: string;
  invoiceDate: Date;
  dueDate: Date;

  items: InvoiceItem[];

  subtotal: number;
  taxAmount: number;
  total: number;

  paidAmount: number;
  balance: number;

  status: 'DRAFT' | 'SENT' | 'PARTIAL' | 'PAID' | 'OVERDUE' | 'VOID';

  paymentTerms: string;
  notes?: string;

  payments: Payment[];
}

interface Payment {
  id: string;
  paymentNumber: string;
  invoiceId: string;
  date: Date;
  amount: number;
  method: 'CASH' | 'BANK_TRANSFER' | 'CHECK' | 'CREDIT_CARD';
  reference?: string;
  bankAccountId?: string;
  status: 'PENDING' | 'CLEARED' | 'BOUNCED';
}
```

### 3. æ‡‰ä»˜å¸³æ¬¾ç®¡ç†

```typescript
interface Bill {
  id: string;
  billNumber: string;
  vendorId: string;
  billDate: Date;
  dueDate: Date;

  items: BillItem[];

  subtotal: number;
  taxAmount: number;
  total: number;

  paidAmount: number;
  balance: number;

  status: 'DRAFT' | 'APPROVED' | 'PARTIAL' | 'PAID' | 'OVERDUE';

  approvedBy?: string;
  approvedAt?: Date;
}
```

### 4. å›ºå®šè³‡ç”¢ç®¡ç†

```typescript
interface FixedAsset {
  id: string;
  assetNumber: string;
  name: string;
  category: string;

  // è³¼ç½®è³‡è¨Š
  purchaseDate: Date;
  purchaseCost: number;
  vendorId: string;

  // æŠ˜èˆŠè³‡è¨Š
  depreciationMethod: 'STRAIGHT_LINE' | 'DECLINING_BALANCE' | 'UNITS_OF_PRODUCTION';
  usefulLife: number; // å¹´
  salvageValue: number;

  // å¸³é¢åƒ¹å€¼
  accumulatedDepreciation: number;
  bookValue: number;

  // è™•ç½®è³‡è¨Š
  disposalDate?: Date;
  disposalAmount?: number;
  disposalMethod?: 'SALE' | 'SCRAP' | 'DONATION';

  status: 'IN_USE' | 'DISPOSED' | 'UNDER_MAINTENANCE';
  location: string;
  responsiblePerson: string;
}
```

### 5. è²¡å‹™å ±è¡¨

```typescript
// è³‡ç”¢è² å‚µè¡¨ (Balance Sheet)
interface BalanceSheet {
  date: Date;

  // è³‡ç”¢
  assets: {
    currentAssets: AssetCategory[];
    fixedAssets: AssetCategory[];
    otherAssets: AssetCategory[];
    totalAssets: number;
  };

  // è² å‚µ
  liabilities: {
    currentLiabilities: LiabilityCategory[];
    longTermLiabilities: LiabilityCategory[];
    totalLiabilities: number;
  };

  // æ¬Šç›Š
  equity: {
    capital: number;
    retainedEarnings: number;
    totalEquity: number;
  };
}

// æç›Šè¡¨ (Income Statement)
interface IncomeStatement {
  period: {
    startDate: Date;
    endDate: Date;
  };

  revenue: {
    operatingRevenue: number;
    otherRevenue: number;
    totalRevenue: number;
  };

  costOfGoodsSold: number;
  grossProfit: number;

  operatingExpenses: ExpenseCategory[];
  totalOperatingExpenses: number;

  operatingIncome: number;

  otherIncomeExpenses: number;

  incomeBeforeTax: number;
  incomeTax: number;
  netIncome: number;
}

// ç¾é‡‘æµé‡è¡¨ (Cash Flow Statement)
interface CashFlowStatement {
  period: {
    startDate: Date;
    endDate: Date;
  };

  operatingActivities: {
    netIncome: number;
    adjustments: Adjustment[];
    netCashFromOperating: number;
  };

  investingActivities: {
    items: CashFlowItem[];
    netCashFromInvesting: number;
  };

  financingActivities: {
    items: CashFlowItem[];
    netCashFromFinancing: number;
  };

  netChangeInCash: number;
  beginningCash: number;
  endingCash: number;
}
```

---

## ğŸ’» æ¨è–¦æŠ€è¡“æ£§

### å¾Œç«¯å¯¦ç¾

```typescript
// ç¯„ä¾‹ï¼šæœƒè¨ˆæ†‘è­‰æœå‹™
@Injectable()
export class JournalEntryService {
  async createJournalEntry(dto: CreateJournalEntryDto): Promise<JournalEntry> {
    // é©—è­‰å€Ÿè²¸å¹³è¡¡
    const totalDebit = dto.lines.reduce((sum, line) => sum + line.debit, 0);
    const totalCredit = dto.lines.reduce((sum, line) => sum + line.credit, 0);

    if (Math.abs(totalDebit - totalCredit) > 0.01) {
      throw new BadRequestException('å€Ÿè²¸ä¸å¹³è¡¡');
    }

    const entry = new JournalEntry();
    entry.journalNumber = await this.generateJournalNumber();
    entry.date = dto.date;
    entry.description = dto.description;
    entry.lines = dto.lines;
    entry.totalDebit = totalDebit;
    entry.totalCredit = totalCredit;
    entry.status = 'DRAFT';

    return await this.journalEntryRepository.save(entry);
  }

  async postJournalEntry(id: string): Promise<JournalEntry> {
    const entry = await this.findOne(id);

    if (entry.status !== 'DRAFT') {
      throw new BadRequestException('åªèƒ½éå¸³è‰ç¨¿ç‹€æ…‹çš„æ†‘è­‰');
    }

    // ä½¿ç”¨äº‹å‹™æ›´æ–°å¸³æˆ¶é¤˜é¡
    await this.dataSource.transaction(async (manager) => {
      for (const line of entry.lines) {
        await this.updateAccountBalance(
          line.accountId,
          line.debit,
          line.credit,
          manager,
        );
      }

      entry.status = 'POSTED';
      entry.postedAt = new Date();
      await manager.save(entry);
    });

    return entry;
  }

  private async updateAccountBalance(
    accountId: string,
    debit: number,
    credit: number,
    manager: EntityManager,
  ): Promise<void> {
    const account = await manager.findOne(Account, accountId);

    // æ ¹æ“šç§‘ç›®æ­£å¸¸é¤˜é¡æ–¹å‘æ›´æ–°
    if (account.normalBalance === 'DEBIT') {
      account.balance += debit - credit;
    } else {
      account.balance += credit - debit;
    }

    await manager.save(account);
  }
}
```

### è²¡å‹™å ±è¡¨ç”Ÿæˆ

```typescript
@Injectable()
export class FinancialReportService {
  async generateBalanceSheet(date: Date): Promise<BalanceSheet> {
    // ç²å–æ‰€æœ‰ç§‘ç›®é¤˜é¡
    const accounts = await this.getAccountBalances(date);

    // åˆ†é¡ç§‘ç›®
    const assets = accounts.filter(a => a.type === 'ASSET');
    const liabilities = accounts.filter(a => a.type === 'LIABILITY');
    const equity = accounts.filter(a => a.type === 'EQUITY');

    // è¨ˆç®—ç¸½é¡
    const totalAssets = this.sumBalances(assets);
    const totalLiabilities = this.sumBalances(liabilities);
    const totalEquity = this.sumBalances(equity);

    // é©—è­‰æœƒè¨ˆç­‰å¼: è³‡ç”¢ = è² å‚µ + æ¬Šç›Š
    if (Math.abs(totalAssets - (totalLiabilities + totalEquity)) > 0.01) {
      throw new Error('è³‡ç”¢è² å‚µè¡¨ä¸å¹³è¡¡');
    }

    return {
      date,
      assets: this.categorizeAssets(assets),
      liabilities: this.categorizeLiabilities(liabilities),
      equity: this.categorizeEquity(equity),
    };
  }

  async generateIncomeStatement(
    startDate: Date,
    endDate: Date,
  ): Promise<IncomeStatement> {
    // ç²å–æœŸé–“å…§çš„æ”¶å…¥å’Œè²»ç”¨
    const revenue = await this.getRevenue(startDate, endDate);
    const expenses = await this.getExpenses(startDate, endDate);
    const cogs = await this.getCOGS(startDate, endDate);

    const totalRevenue = this.sumAmounts(revenue);
    const totalExpenses = this.sumAmounts(expenses);
    const grossProfit = totalRevenue - cogs;
    const operatingIncome = grossProfit - totalExpenses;

    // è¨ˆç®—ç¨…å¾Œæ·¨åˆ©
    const incomeTax = operatingIncome * 0.2; // å‡è¨­ç¨…ç‡ 20%
    const netIncome = operatingIncome - incomeTax;

    return {
      period: { startDate, endDate },
      revenue: { totalRevenue, /* ... */ },
      costOfGoodsSold: cogs,
      grossProfit,
      operatingExpenses: this.categorizeExpenses(expenses),
      totalOperatingExpenses: totalExpenses,
      operatingIncome,
      incomeTax,
      netIncome,
    };
  }
}
```

---

## ğŸ¤– AI æ™ºèƒ½åŠŸèƒ½

### 1. æ™ºèƒ½æ†‘è­‰è­˜åˆ¥

```python
# OCR + AI è‡ªå‹•è­˜åˆ¥ç™¼ç¥¨ä¸¦ç”Ÿæˆæ†‘è­‰
from transformers import pipeline
import pytesseract
from PIL import Image

class IntelligentReceiptProcessing:
    def __init__(self):
        self.ocr_engine = pytesseract
        self.nlp_model = pipeline("ner")

    def process_receipt(self, image_path: str) -> dict:
        """è™•ç†ç™¼ç¥¨åœ–ç‰‡"""
        # OCR æå–æ–‡å­—
        text = self.ocr_engine.image_to_string(Image.open(image_path))

        # ä½¿ç”¨ NLP æå–é—œéµè³‡è¨Š
        entities = self.extract_entities(text)

        # æ™ºèƒ½åˆ†é¡ç§‘ç›®
        account = self.classify_expense_account(entities['description'])

        return {
            'vendor': entities.get('vendor'),
            'date': entities.get('date'),
            'amount': entities.get('amount'),
            'tax': entities.get('tax'),
            'suggested_account': account,
            'confidence': entities.get('confidence'),
        }

    def classify_expense_account(self, description: str) -> str:
        """æ ¹æ“šæè¿°æ™ºèƒ½åˆ†é¡è²»ç”¨ç§‘ç›®"""
        # ä½¿ç”¨é è¨“ç·´æ¨¡å‹åˆ†é¡
        # å¦‚: "è¾¦å…¬å®¤ç§Ÿé‡‘" -> "ç§Ÿé‡‘è²»ç”¨"
        #    "å“¡å·¥åˆé¤" -> "é¤é£²è²»ç”¨"
        classification = self.classifier.predict(description)
        return classification['account_code']
```

### 2. ç•°å¸¸æª¢æ¸¬

```typescript
// AI é©…å‹•çš„è²¡å‹™ç•°å¸¸æª¢æ¸¬
class FinancialAnomalyDetection {
  async detectAnomalies(period: Period): Promise<Anomaly[]> {
    const transactions = await this.getTransactions(period);
    const anomalies: Anomaly[] = [];

    for (const transaction of transactions) {
      // 1. é‡‘é¡ç•°å¸¸
      if (await this.isAmountAnomaly(transaction)) {
        anomalies.push({
          type: 'UNUSUAL_AMOUNT',
          transaction,
          severity: 'HIGH',
          description: 'é‡‘é¡ç•°å¸¸ï¼šé¡¯è‘—åé›¢æ­·å²å¹³å‡å€¼',
        });
      }

      // 2. é‡è¤‡äº¤æ˜“
      if (await this.isDuplicate(transaction)) {
        anomalies.push({
          type: 'DUPLICATE',
          transaction,
          severity: 'MEDIUM',
          description: 'å¯èƒ½çš„é‡è¤‡äº¤æ˜“',
        });
      }

      // 3. ä¸å°‹å¸¸çš„ç§‘ç›®é…å°
      if (await this.isUnusualAccountPairing(transaction)) {
        anomalies.push({
          type: 'UNUSUAL_PAIRING',
          transaction,
          severity: 'LOW',
          description: 'ä¸å¸¸è¦‹çš„ç§‘ç›®é…å°',
        });
      }

      // 4. é€±æœ«äº¤æ˜“
      if (this.isWeekendTransaction(transaction)) {
        anomalies.push({
          type: 'WEEKEND_TRANSACTION',
          transaction,
          severity: 'LOW',
          description: 'é€±æœ«äº¤æ˜“éœ€è¦å¯©æŸ¥',
        });
      }
    }

    return anomalies;
  }
}
```

### 3. è²¡å‹™é æ¸¬

```python
# ä½¿ç”¨æ™‚é–“åºåˆ—é æ¸¬ç¾é‡‘æµ
from prophet import Prophet
import pandas as pd

class CashFlowForecast:
    def forecast_cash_flow(self, months: int = 12) -> dict:
        """é æ¸¬æœªä¾†ç¾é‡‘æµ"""
        # ç²å–æ­·å²ç¾é‡‘æµæ•¸æ“š
        historical_data = self.get_historical_cash_flow()

        # æº–å‚™æ•¸æ“š
        df = pd.DataFrame({
            'ds': historical_data['dates'],
            'y': historical_data['amounts'],
        })

        # å»ºç«‹æ¨¡å‹
        model = Prophet(
            yearly_seasonality=True,
            weekly_seasonality=False,
            daily_seasonality=False,
        )
        model.fit(df)

        # é æ¸¬æœªä¾†
        future = model.make_future_dataframe(periods=months, freq='M')
        forecast = model.predict(future)

        return {
            'forecast': forecast[['ds', 'yhat', 'yhat_lower', 'yhat_upper']].tail(months),
            'trend': self.analyze_trend(forecast),
            'seasonality': self.analyze_seasonality(model),
            'alerts': self.generate_alerts(forecast),
        }
```

---

## ğŸ”’ å®‰å…¨èˆ‡åˆè¦

### å¯©è¨ˆè¿½è¹¤

```typescript
// å®Œæ•´çš„å¯©è¨ˆæ—¥èªŒ
interface AuditLog {
  id: string;
  timestamp: Date;
  userId: string;
  action: 'CREATE' | 'UPDATE' | 'DELETE' | 'POST' | 'VOID';
  entityType: 'JOURNAL_ENTRY' | 'INVOICE' | 'PAYMENT';
  entityId: string;
  oldValue?: any;
  newValue?: any;
  ipAddress: string;
  userAgent: string;
}

// è‡ªå‹•è¨˜éŒ„æ‰€æœ‰è²¡å‹™æ“ä½œ
@Injectable()
export class AuditService {
  async logChange(params: AuditLogParams): Promise<void> {
    const log = new AuditLog();
    log.timestamp = new Date();
    log.userId = params.userId;
    log.action = params.action;
    log.entityType = params.entityType;
    log.entityId = params.entityId;
    log.oldValue = params.oldValue;
    log.newValue = params.newValue;

    await this.auditLogRepository.save(log);
  }
}
```

### æ¬Šé™æ§åˆ¶

```typescript
// ç´°ç²’åº¦çš„æ¬Šé™æ§åˆ¶
enum FinancePermission {
  // æ†‘è­‰
  CREATE_JOURNAL_ENTRY = 'finance:journal:create',
  POST_JOURNAL_ENTRY = 'finance:journal:post',
  VOID_JOURNAL_ENTRY = 'finance:journal:void',

  // æ‡‰æ”¶
  CREATE_INVOICE = 'finance:invoice:create',
  APPROVE_INVOICE = 'finance:invoice:approve',

  // æ‡‰ä»˜
  CREATE_BILL = 'finance:bill:create',
  APPROVE_BILL = 'finance:bill:approve',

  // å ±è¡¨
  VIEW_FINANCIAL_REPORTS = 'finance:reports:view',
  EXPORT_FINANCIAL_DATA = 'finance:data:export',

  // è¨­å®š
  MANAGE_CHART_OF_ACCOUNTS = 'finance:accounts:manage',
  CLOSE_PERIOD = 'finance:period:close',
}
```

---

## ğŸ“š åƒè€ƒè³‡æº

### æœƒè¨ˆæº–å‰‡
- **IFRS** - åœ‹éš›è²¡å‹™å ±å°æº–å‰‡
- **GAAP** - ä¸€èˆ¬å…¬èªæœƒè¨ˆåŸå‰‡
- **æœ¬åœ°æœƒè¨ˆæº–å‰‡** - å„åœ‹å®¶åœ°å€æº–å‰‡

### é–‹æºè²¡å‹™è»Ÿé«”
- **GNUCash** - å€‹äºº/å°ä¼æ¥­è²¡å‹™è»Ÿé«”
- **Odoo Accounting** - Odoo æœƒè¨ˆæ¨¡çµ„
- **ERPNext** - åŒ…å«æœƒè¨ˆåŠŸèƒ½çš„ ERP

---

**ğŸš€ é–‹å§‹ä½¿ç”¨ AI å»ºç«‹ä½ çš„è²¡å‹™æœƒè¨ˆç³»çµ±ï¼Œç¢ºä¿è²¡å‹™æº–ç¢ºèˆ‡åˆè¦ï¼**
