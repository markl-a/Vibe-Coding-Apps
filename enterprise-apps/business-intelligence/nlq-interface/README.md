# è‡ªç„¶è¯­è¨€æŸ¥è¯¢æ¥å£ (Natural Language Query Interface)

ğŸ¤– **AI-Powered | å¯¹è¯å¼æ•°æ®åˆ†æ** ğŸš€

è‡ªç„¶è¯­è¨€æŸ¥è¯¢ (NLQ) æ¥å£å…è®¸ç”¨æˆ·ä½¿ç”¨æ—¥å¸¸è¯­è¨€æé—®æ•°æ®é—®é¢˜ï¼Œç³»ç»Ÿè‡ªåŠ¨å°†é—®é¢˜è½¬æ¢ä¸º SQL æŸ¥è¯¢ã€æ‰§è¡Œå¹¶è¿”å›ç»“æœï¼Œæ— éœ€ç¼–å†™ä»£ç ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### 1. è‡ªç„¶è¯­è¨€åˆ° SQL
- ç†è§£ä¸­æ–‡å’Œè‹±æ–‡é—®é¢˜
- è‡ªåŠ¨ç”Ÿæˆ SQL æŸ¥è¯¢
- æ”¯æŒå¤æ‚æŸ¥è¯¢ï¼ˆJOIN, GROUP BY, èšåˆç­‰ï¼‰
- æ™ºèƒ½è¡¨å’Œåˆ—åæ˜ å°„

### 2. æŸ¥è¯¢æ‰§è¡Œä¸ç»“æœå±•ç¤º
- è‡ªåŠ¨æ‰§è¡Œç”Ÿæˆçš„ SQL
- å¤šç§ç»“æœå±•ç¤ºæ ¼å¼ï¼ˆè¡¨æ ¼ã€å›¾è¡¨ã€å¡ç‰‡ï¼‰
- æ™ºèƒ½å¯è§†åŒ–æ¨è
- ç»“æœå¯¼å‡ºï¼ˆCSV, Excel, JSONï¼‰

### 3. ä¸Šä¸‹æ–‡ç†è§£
- è®°ä½å¯¹è¯å†å²
- æ”¯æŒè¿½é—®å’Œç»†åŒ–
- è‡ªåŠ¨å…³è”ç›¸å…³è¡¨
- æ™ºèƒ½è¡¥å…¨å’Œå»ºè®®

### 4. AI é©±åŠ¨çš„æ´å¯Ÿ
- è‡ªåŠ¨ç”Ÿæˆç»“æœæ‘˜è¦
- å‘ç°æ•°æ®è¶‹åŠ¿å’Œå¼‚å¸¸
- æä¾›ä¸šåŠ¡å»ºè®®
- ç›¸å…³é—®é¢˜æ¨è

### 5. æŸ¥è¯¢ä¼˜åŒ–
- SQL æŸ¥è¯¢ä¼˜åŒ–
- æ€§èƒ½åˆ†æ
- ç¼“å­˜æœºåˆ¶
- æŸ¥è¯¢å†å²è®°å½•

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### ä¸šåŠ¡åˆ†æå¸ˆ
```
é—®é¢˜: "ä¸Šä¸ªæœˆé”€å”®é¢æœ€é«˜çš„5ä¸ªäº§å“æ˜¯ä»€ä¹ˆï¼Ÿ"
SQL: SELECT product_name, SUM(amount) as total_sales
     FROM sales
     WHERE date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH)
     GROUP BY product_name
     ORDER BY total_sales DESC
     LIMIT 5
ç»“æœ: [è¡¨æ ¼ + æŸ±çŠ¶å›¾]
```

### è¿è¥ç»ç†
```
é—®é¢˜: "æŒ‰åœ°åŒºç»Ÿè®¡ä»Šå¹´çš„è®¢å•æ•°é‡"
SQL: SELECT region, COUNT(*) as order_count
     FROM orders
     WHERE YEAR(order_date) = YEAR(CURDATE())
     GROUP BY region
ç»“æœ: [è¡¨æ ¼ + é¥¼å›¾]
```

### äº§å“ç»ç†
```
é—®é¢˜: "ç”¨æˆ·ç•™å­˜ç‡çš„è¶‹åŠ¿å¦‚ä½•ï¼Ÿ"
SQL: [ç”Ÿæˆå¤æ‚çš„ cohort åˆ†ææŸ¥è¯¢]
ç»“æœ: [æŠ˜çº¿å›¾ + çƒ­åŠ›å›¾ + AI æ´å¯Ÿ]
```

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç”¨æˆ·è¾“å…¥                       â”‚
â”‚    "ä¸Šä¸ªæœˆé”€å”®é¢æ˜¯å¤šå°‘ï¼Ÿ"                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        NLP å¤„ç†å±‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ æ„å›¾è¯†åˆ« â”‚ å®ä½“æå– â”‚ è¯­ä¹‰ç†è§£ â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        SQL ç”Ÿæˆå™¨                        â”‚
â”‚  - æ¨¡å¼æ˜ å°„ï¼ˆSchema Mappingï¼‰            â”‚
â”‚  - æŸ¥è¯¢æ„å»ºï¼ˆQuery Buildingï¼‰            â”‚
â”‚  - è¯­æ³•éªŒè¯ï¼ˆSyntax Validationï¼‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æŸ¥è¯¢æ‰§è¡Œå¼•æ“                      â”‚
â”‚  - æŸ¥è¯¢ä¼˜åŒ–                              â”‚
â”‚  - å®‰å…¨æ£€æŸ¥                              â”‚
â”‚  - ç»“æœè·å–                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ç»“æœå¤„ç†å±‚                        â”‚
â”‚  - æ ¼å¼åŒ–è¾“å‡º                            â”‚
â”‚  - å¯è§†åŒ–æ¨è                            â”‚
â”‚  - AI æ‘˜è¦ç”Ÿæˆ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç”¨æˆ·ç•Œé¢                       â”‚
â”‚  [è¡¨æ ¼] [å›¾è¡¨] [æ´å¯Ÿ] [å»ºè®®]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. é…ç½®æ•°æ®åº“ï¼ˆå¯é€‰ï¼‰

```bash
# ä½¿ç”¨ SQLiteï¼ˆé»˜è®¤ï¼‰
python setup_database.py

# æˆ–é…ç½®å¤–éƒ¨æ•°æ®åº“
export DB_TYPE=postgresql
export DB_HOST=localhost
export DB_PORT=5432
export DB_NAME=mydb
export DB_USER=user
export DB_PASSWORD=password
```

### 3. ç”Ÿæˆæ¼”ç¤ºæ•°æ®

```bash
python data_generator.py
```

### 4. å¯åŠ¨åº”ç”¨

```bash
streamlit run app.py
```

åº”ç”¨å°†åœ¨ http://localhost:8501 å¯åŠ¨ã€‚

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€æŸ¥è¯¢

```python
from nlq_engine import NLQEngine

engine = NLQEngine()

# é—®é¢˜ 1: ç®€å•èšåˆ
question = "æ€»é”€å”®é¢æ˜¯å¤šå°‘ï¼Ÿ"
result = engine.query(question)
print(result.sql)       # SELECT SUM(amount) FROM sales
print(result.answer)    # "æ€»é”€å”®é¢ä¸º $1,234,567"

# é—®é¢˜ 2: è¿‡æ»¤å’Œåˆ†ç»„
question = "å„ä¸ªåœ°åŒºçš„å¹³å‡è®¢å•é‡‘é¢"
result = engine.query(question)
print(result.data)      # DataFrame with results
print(result.visualization)  # æ¨èçš„å›¾è¡¨ç±»å‹
```

### ä¸Šä¸‹æ–‡å¯¹è¯

```python
# ç¬¬ä¸€ä¸ªé—®é¢˜
q1 = "æ˜¾ç¤ºæ‰€æœ‰äº§å“ç±»åˆ«"
r1 = engine.query(q1)

# è¿½é—®ï¼ˆç³»ç»Ÿä¼šè®°ä½ä¸Šä¸‹æ–‡ï¼‰
q2 = "å…¶ä¸­é”€å”®é¢æœ€é«˜çš„æ˜¯å“ªä¸ªï¼Ÿ"
r2 = engine.query(q2, context=r1)

# ç»§ç»­ç»†åŒ–
q3 = "æ˜¾ç¤ºè¯¥ç±»åˆ«çš„æœˆåº¦è¶‹åŠ¿"
r3 = engine.query(q3, context=r2)
```

### å¤æ‚æŸ¥è¯¢

```python
# å¤šè¡¨ JOIN
question = "æ˜¾ç¤ºæ¯ä¸ªé”€å”®äººå‘˜çš„å®¢æˆ·æ•°é‡å’Œæ€»ä¸šç»©"
result = engine.query(question)

# æ—¶é—´èŒƒå›´åˆ†æ
question = "å¯¹æ¯”ä»Šå¹´å’Œå»å¹´åŒæœŸçš„é”€å”®æƒ…å†µ"
result = engine.query(question)

# æ’åå’Œç™¾åˆ†ä½
question = "åˆ—å‡ºé”€å”®é¢æ’åå‰ 10% çš„å®¢æˆ·"
result = engine.query(question)
```

## ğŸ¨ é—®é¢˜ç±»å‹

ç³»ç»Ÿæ”¯æŒä»¥ä¸‹ç±»å‹çš„é—®é¢˜ï¼š

### 1. èšåˆæŸ¥è¯¢
- "æ€»é”€å”®é¢æ˜¯å¤šå°‘ï¼Ÿ"
- "å¹³å‡è®¢å•é‡‘é¢"
- "æœ€å¤§/æœ€å°å€¼"
- "è®¡æ•°"

### 2. åˆ†ç»„å’Œæ’åº
- "æŒ‰åœ°åŒºåˆ†ç»„çš„é”€å”®é¢"
- "é”€å”®é¢æœ€é«˜çš„äº§å“"
- "æ’åå‰10çš„å®¢æˆ·"

### 3. æ—¶é—´åˆ†æ
- "ä¸Šä¸ªæœˆçš„é”€å”®æƒ…å†µ"
- "æ¯å‘¨/æ¯æœˆè¶‹åŠ¿"
- "åŒæ¯”/ç¯æ¯”å¢é•¿"
- "å¹´åº¦æ€»ç»“"

### 4. è¿‡æ»¤å’Œæ¡ä»¶
- "é”€å”®é¢è¶…è¿‡10000çš„è®¢å•"
- "åŒ—äº¬åœ°åŒºçš„å®¢æˆ·"
- "2024å¹´çš„æ•°æ®"

### 5. æ¯”è¾ƒå’Œå¯¹æ¯”
- "ä»Šå¹´ vs å»å¹´"
- "äº§å“Aå’Œäº§å“Bçš„é”€é‡å¯¹æ¯”"
- "å„åœ°åŒºçš„è¡¨ç°å·®å¼‚"

### 6. ç›¸å…³æ€§å’Œæ´å¯Ÿ
- "ä»€ä¹ˆå› ç´ å½±å“é”€å”®é¢ï¼Ÿ"
- "æ‰¾å‡ºå¼‚å¸¸çš„è®¢å•"
- "é¢„æµ‹ä¸‹ä¸ªæœˆçš„é”€å”®"

## ğŸ§  AI æ¨¡å‹

ç³»ç»Ÿä½¿ç”¨å¤šç§ AI æŠ€æœ¯ï¼š

| æŠ€æœ¯ | ç”¨é€” | å¤‡æ³¨ |
|------|------|------|
| **è§„åˆ™å¼•æ“** | ç®€å•æŸ¥è¯¢è½¬æ¢ | å¿«é€Ÿã€å¯é  |
| **æ­£åˆ™è¡¨è¾¾å¼** | æ¨¡å¼åŒ¹é… | å¤„ç†å¸¸è§é—®é¢˜ |
| **spaCy NLP** | å®ä½“è¯†åˆ«ã€ä¾å­˜åˆ†æ | ç†è§£è¯­è¨€ç»“æ„ |
| **LLM (å¯é€‰)** | å¤æ‚æŸ¥è¯¢ç†è§£ | GPT/Claude API |
| **æ¨¡æ¿åŒ¹é…** | å¸¸è§é—®é¢˜æ¨¡å¼ | æé«˜å‡†ç¡®æ€§ |

### æœ¬åœ°æ¨¡å¼ï¼ˆæ— éœ€ APIï¼‰

```python
engine = NLQEngine(mode='local')  # åªä½¿ç”¨è§„åˆ™å’Œæ¨¡æ¿
```

### AI å¢å¼ºæ¨¡å¼ï¼ˆéœ€è¦ API Keyï¼‰

```python
engine = NLQEngine(
    mode='ai',
    api_key='your-api-key',
    model='gpt-4'  # æˆ– 'claude-3-opus'
)
```

## ğŸ“Š æ”¯æŒçš„æ•°æ®åº“

- **SQLite** âœ… (é»˜è®¤ï¼Œæ— éœ€é…ç½®)
- **PostgreSQL** âœ…
- **MySQL** âœ…
- **SQL Server** âœ…
- **Pandas DataFrame** âœ… (CSV/Excel)

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### SQL æ³¨å…¥é˜²æŠ¤
- å‚æ•°åŒ–æŸ¥è¯¢
- SQL å…³é”®è¯é»‘åå•
- åªè¯»æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
- æŸ¥è¯¢ç™½åå•

### æƒé™æ§åˆ¶
- è¡¨çº§è®¿é—®æ§åˆ¶
- åˆ—çº§æ•°æ®è„±æ•
- æŸ¥è¯¢å®¡è®¡æ—¥å¿—
- é€Ÿç‡é™åˆ¶

```python
# é…ç½®å®‰å…¨ç­–ç•¥
engine = NLQEngine(
    readonly=True,              # åªå…è®¸ SELECT
    allowed_tables=['sales', 'customers'],  # é™åˆ¶è¡¨
    max_results=1000,           # é™åˆ¶è¿”å›è¡Œæ•°
    timeout=30                  # æŸ¥è¯¢è¶…æ—¶
)
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥
```python
# å¯ç”¨æŸ¥è¯¢ç¼“å­˜
engine = NLQEngine(cache_enabled=True)

# ç›¸åŒé—®é¢˜ç›´æ¥è¿”å›ç¼“å­˜ç»“æœ
r1 = engine.query("æ€»é”€å”®é¢")  # æ‰§è¡Œ SQL
r2 = engine.query("æ€»é”€å”®é¢")  # è¿”å›ç¼“å­˜ï¼ˆ<1msï¼‰
```

### æŸ¥è¯¢ä¼˜åŒ–
- è‡ªåŠ¨æ·»åŠ ç´¢å¼•å»ºè®®
- æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’åˆ†æ
- æ…¢æŸ¥è¯¢è­¦å‘Š
- ç»“æœåˆ†é¡µ

## ğŸ¯ é«˜çº§åŠŸèƒ½

### 1. æ™ºèƒ½è¡¨è¿æ¥

ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«è¡¨å…³ç³»ï¼š
```
é—®é¢˜: "æ˜¾ç¤ºæ¯ä¸ªå®¢æˆ·çš„è®¢å•æ•°é‡"
è‡ªåŠ¨ç”Ÿæˆ: SELECT c.name, COUNT(o.id)
          FROM customers c
          LEFT JOIN orders o ON c.id = o.customer_id
          GROUP BY c.id, c.name
```

### 2. æ¨¡ç³ŠåŒ¹é…

```
ç”¨æˆ·: "salse"ï¼ˆæ‹¼å†™é”™è¯¯ï¼‰
ç³»ç»Ÿ: "æ‚¨æ˜¯å¦æƒ³æŸ¥è¯¢ 'sales' (é”€å”®)ï¼Ÿ"
```

### 3. å¤šè¯­è¨€æ”¯æŒ

```python
# ä¸­æ–‡
engine.query("ä¸Šä¸ªæœˆçš„é”€å”®é¢")

# è‹±æ–‡
engine.query("What was the revenue last month?")

# æ··åˆ
engine.query("Show me the top 5 äº§å“ by é”€å”®é¢")
```

### 4. è‡ªå®šä¹‰ä¸šåŠ¡æœ¯è¯­

```python
# å®šä¹‰ä¸šåŠ¡æœ¯è¯­æ˜ å°„
engine.add_term_mapping({
    "GMV": "SUM(order_amount)",
    "æ´»è·ƒç”¨æˆ·": "COUNT(DISTINCT user_id) WHERE last_active >= DATE_SUB(NOW(), INTERVAL 30 DAY)",
    "å¤è´­ç‡": "COUNT(DISTINCT CASE WHEN order_count > 1 THEN customer_id END) / COUNT(DISTINCT customer_id)"
})

# ä½¿ç”¨ä¸šåŠ¡æœ¯è¯­
engine.query("æœ¬æœˆçš„GMVå’Œå¤è´­ç‡")
```

## ğŸ“š API æ–‡æ¡£

### NLQEngine

```python
class NLQEngine:
    def __init__(
        self,
        db_path: str = 'data/database.db',
        mode: str = 'local',  # 'local' or 'ai'
        api_key: Optional[str] = None,
        cache_enabled: bool = True
    )

    def query(
        self,
        question: str,
        context: Optional[QueryResult] = None,
        visualize: bool = True
    ) -> QueryResult

    def explain_query(
        self,
        question: str
    ) -> Dict[str, Any]

    def optimize_query(
        self,
        sql: str
    ) -> str

    def get_suggestions(
        self,
        partial_question: str
    ) -> List[str]
```

### QueryResult

```python
class QueryResult:
    question: str           # åŸå§‹é—®é¢˜
    sql: str               # ç”Ÿæˆçš„ SQL
    data: pd.DataFrame     # æŸ¥è¯¢ç»“æœ
    answer: str            # è‡ªç„¶è¯­è¨€ç­”æ¡ˆ
    visualization: Dict    # æ¨èå¯è§†åŒ–
    insights: List[str]    # AI æ´å¯Ÿ
    execution_time: float  # æ‰§è¡Œæ—¶é—´
```

## ğŸ”§ é…ç½®æ–‡ä»¶

åˆ›å»º `config.yaml`ï¼š

```yaml
# æ•°æ®åº“é…ç½®
database:
  type: sqlite
  path: data/database.db

# NLP é…ç½®
nlp:
  mode: local  # 'local' or 'ai'
  language: zh_CN
  spacy_model: zh_core_web_sm

# AI é…ç½®ï¼ˆå¯é€‰ï¼‰
ai:
  provider: openai  # 'openai' or 'anthropic'
  model: gpt-4
  api_key: ${OPENAI_API_KEY}

# å®‰å…¨é…ç½®
security:
  readonly: true
  allowed_tables: all
  max_results: 10000
  timeout: 60

# ç¼“å­˜é…ç½®
cache:
  enabled: true
  ttl: 3600  # 1å°æ—¶
  max_size: 1000

# UI é…ç½®
ui:
  default_chart: bar
  theme: light
  show_sql: true
```

## ğŸ“Š ç¤ºä¾‹é—®é¢˜åº“

ç³»ç»Ÿå†…ç½®å¸¸è§é—®é¢˜æ¨¡æ¿ï¼š

**é”€å”®åˆ†æ**
- æ€»é”€å”®é¢/æ”¶å…¥/è¥ä¸šé¢
- æŒ‰æ—¶é—´/åœ°åŒº/äº§å“çš„é”€å”®
- Top N äº§å“/å®¢æˆ·/åœ°åŒº
- åŒæ¯”/ç¯æ¯”å¢é•¿

**å®¢æˆ·åˆ†æ**
- å®¢æˆ·æ•°é‡/æ–°å®¢æˆ·/æ´»è·ƒç”¨æˆ·
- å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼
- å®¢æˆ·æµå¤±ç‡
- RFM åˆ†æ

**è¿è¥æŒ‡æ ‡**
- è®¢å•é‡/è½¬åŒ–ç‡/å®¢å•ä»·
- åº“å­˜å‘¨è½¬ç‡
- é…é€æ—¶æ•ˆ
- é€€è´§ç‡

## ğŸ“ æœ€ä½³å®è·µ

### 1. æ¸…æ™°æ˜ç¡®çš„é—®é¢˜
âœ… å¥½: "2024å¹´å„åœ°åŒºçš„é”€å”®é¢"
âŒ å·®: "é”€å”®"

### 2. æŒ‡å®šæ—¶é—´èŒƒå›´
âœ… å¥½: "ä¸Šä¸ªæœˆçš„æ–°ç”¨æˆ·æ•°"
âŒ å·®: "æ–°ç”¨æˆ·æ•°"

### 3. æ˜ç¡®èšåˆæ–¹å¼
âœ… å¥½: "å¹³å‡è®¢å•é‡‘é¢"
âŒ å·®: "è®¢å•é‡‘é¢"

### 4. ä½¿ç”¨æ ‡å‡†æœ¯è¯­
âœ… å¥½: "é”€å”®é¢"ã€"æ”¶å…¥"
âŒ å·®: "å–äº†å¤šå°‘é’±"

## ğŸš§ é™åˆ¶å’Œæ³¨æ„äº‹é¡¹

1. **æŸ¥è¯¢å¤æ‚åº¦**: éå¸¸å¤æ‚çš„æŸ¥è¯¢å¯èƒ½éœ€è¦æ‰‹åŠ¨ç¼–å†™ SQL
2. **æ•°æ®åº“å…¼å®¹æ€§**: æŸäº› SQL æ–¹è¨€ç‰¹æœ‰åŠŸèƒ½å¯èƒ½ä¸æ”¯æŒ
3. **æ€§èƒ½**: å¤§æ•°æ®é›†å»ºè®®ä½¿ç”¨æ•°æ®åº“ç´¢å¼•
4. **å‡†ç¡®æ€§**: AI æ¨¡å¼å‡†ç¡®ç‡æ›´é«˜ä½†éœ€è¦ API æˆæœ¬

## ğŸ“¦ æ‰©å±•

### æ·»åŠ è‡ªå®šä¹‰æŸ¥è¯¢å¤„ç†å™¨

```python
from nlq_engine import NLQEngine, QueryProcessor

class MyCustomProcessor(QueryProcessor):
    def can_handle(self, question: str) -> bool:
        return "è‡ªå®šä¹‰å…³é”®è¯" in question

    def process(self, question: str) -> str:
        # è¿”å› SQL
        return "SELECT ..."

engine = NLQEngine()
engine.add_processor(MyCustomProcessor())
```

## ğŸ¤ é›†æˆ

### Slack é›†æˆ
```python
from slack_bolt import App
from nlq_engine import NLQEngine

app = App(token="...")
engine = NLQEngine()

@app.message("data:")
def handle_data_query(message, say):
    question = message['text'].replace('data:', '').strip()
    result = engine.query(question)
    say(result.answer)
```

### API æœåŠ¡
```python
from fastapi import FastAPI
from nlq_engine import NLQEngine

app = FastAPI()
engine = NLQEngine()

@app.post("/query")
def query_data(question: str):
    result = engine.query(question)
    return {
        "answer": result.answer,
        "data": result.data.to_dict(),
        "sql": result.sql
    }
```

## ğŸ“„ è®¸å¯è¯

MIT License

---

**ğŸš€ è®©æ¯ä¸ªäººéƒ½èƒ½åƒæ•°æ®åˆ†æå¸ˆä¸€æ ·æé—®æ•°æ®ï¼**
