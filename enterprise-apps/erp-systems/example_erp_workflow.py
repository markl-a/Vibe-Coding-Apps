"""
ERP 系統綜合範例
展示完整的企業資源規劃流程
"""

import os
import sys
from datetime import datetime

print("""
╔══════════════════════════════════════════════════════════════════════════════╗
║                         ERP 系統綜合範例                                      ║
║                                                                              ║
║  企業資源規劃系統 - 涵蓋業務全流程:                                           ║
║  1. 銷售訂單管理 (Sales Order System)                                       ║
║  2. 採購訂單管理 (Purchase Order System)                                    ║
║  3. 庫存管理 (Inventory Management)                                         ║
║  4. 財務會計 (Financial Accounting)                                         ║
╚══════════════════════════════════════════════════════════════════════════════╝
""")

def demo_sales_order_system():
    """銷售訂單系統示範"""
    print("\n" + "🔵" * 40)
    print("模組 1: 銷售訂單管理系統")
    print("🔵" * 40)

    print("""
📦 銷售訂單系統功能 (完整度: 95%):
   ✓ 客戶管理
   ✓ 銷售訂單創建與追蹤
   ✓ 出貨管理
   ✓ 應收帳款管理
   ✓ 訂單狀態追蹤

🚀 快速開始:
   cd sales-order-system
   pip install -r requirements.txt
   python example_usage.py

💡 核心功能展示:

1. 客戶管理
   - 創建客戶檔案
   - 記錄聯絡資訊
   - 信用額度控制

2. 訂單處理流程:
   新訂單 → 確認 → 備貨 → 出貨 → 開立發票 → 收款 → 完成

3. 出貨管理:
   - 出貨單生成
   - 物流追蹤
   - 簽收確認

4. 應收管理:
   - 發票開立
   - 收款記錄
   - 帳齡分析
    """)

    # 模擬流程
    print("\n【模擬：完整銷售流程】")
    print("1. 客戶下單: 訂單 #SO2025001")
    print("   客戶: ABC 科技股份有限公司")
    print("   產品: 筆記型電腦 x 10")
    print("   金額: $50,000")
    print()
    print("2. 訂單確認 ✓")
    print("   檢查庫存: 充足")
    print("   信用額度: 通過")
    print()
    print("3. 出貨準備 ✓")
    print("   出貨單號: #DN2025001")
    print("   預計出貨: 2025-11-20")
    print()
    print("4. 開立發票 ✓")
    print("   發票號碼: #INV2025001")
    print("   付款條件: Net 30")
    print()
    print("5. 收款記錄 ✓")
    print("   收款日期: 2025-12-15")
    print("   收款金額: $50,000")
    print("   狀態: 已完成")

def demo_purchase_order_system():
    """採購訂單系統示範"""
    print("\n" + "🟢" * 40)
    print("模組 2: 採購訂單管理系統")
    print("🟢" * 40)

    print("""
📋 採購訂單系統功能 (完整度: 95%):
   ✓ 供應商管理
   ✓ 採購申請與審批
   ✓ 採購訂單管理
   ✓ 收貨驗收
   ✓ 應付帳款管理

🚀 快速開始:
   cd purchase-order-system
   pip install -r requirements.txt
   python example_usage.py

💡 核心功能展示:

1. 供應商管理
   - 供應商資料維護
   - 績效評估
   - 價格比較

2. 採購流程:
   需求產生 → 詢價 → 比價 → 下單 → 審批 → 收貨 → 驗收 → 付款

3. 收貨管理:
   - 收貨單記錄
   - 品質檢驗
   - 入庫處理

4. 應付管理:
   - 付款條件追蹤
   - 付款批次處理
   - 帳齡管理
    """)

    # 模擬流程
    print("\n【模擬：完整採購流程】")
    print("1. 採購需求: PR2025001")
    print("   需求部門: IT 部")
    print("   需求品項: SSD 硬碟 x 50")
    print("   預算: $25,000")
    print()
    print("2. 詢價比價 ✓")
    print("   供應商 A: $520/個")
    print("   供應商 B: $480/個 ✓ (選中)")
    print("   供應商 C: $510/個")
    print()
    print("3. 採購訂單: PO2025001")
    print("   供應商: B 電子公司")
    print("   總金額: $24,000")
    print("   交期: 2025-11-25")
    print()
    print("4. 收貨驗收 ✓")
    print("   收貨單: RN2025001")
    print("   驗收狀態: 合格")
    print("   入庫完成: 是")
    print()
    print("5. 付款處理 ✓")
    print("   付款批次: PAY2025001")
    print("   付款金額: $24,000")
    print("   付款日期: 2025-12-10")

def demo_inventory_management():
    """庫存管理系統示範"""
    print("\n" + "🟡" * 40)
    print("模組 3: 庫存管理系統")
    print("🟡" * 40)

    print("""
📦 庫存管理系統功能 (完整度: 90%):
   ✓ 庫存品項管理
   ✓ 入庫/出庫操作
   ✓ 庫存查詢與盤點
   ✓ 低庫存預警
   ✓ 庫存報表

🚀 快速開始:
   cd inventory-management
   pip install -r requirements.txt
   python example_usage.py

💡 核心功能展示:

1. 庫存品項
   - 品項編碼
   - 規格描述
   - 安全庫存設定

2. 庫存異動:
   入庫類型: 採購入庫、退貨入庫、調撥入庫
   出庫類型: 銷貨出庫、報廢出庫、調撥出庫

3. 庫存查詢:
   - 即時庫存
   - 異動記錄
   - 庫齡分析

4. 預警系統:
   - 低庫存預警
   - 過期品預警
   - 呆滯品分析
    """)

    # 模擬庫存狀態
    print("\n【模擬：庫存管理報表】")
    print("\n當前庫存狀態:")
    print("─" * 70)
    print(f"{'品項編碼':<12} {'品名':<20} {'庫存':<8} {'安全庫存':<8} {'狀態':<10}")
    print("─" * 70)

    inventory_items = [
        ("P001", "筆記型電腦", 45, 20, "✓ 正常"),
        ("P002", "SSD 硬碟", 120, 50, "✓ 正常"),
        ("P003", "記憶體", 15, 30, "⚠️ 低庫存"),
        ("P004", "滑鼠", 8, 10, "🔴 嚴重不足"),
        ("P005", "鍵盤", 55, 20, "✓ 正常"),
    ]

    for code, name, stock, safety, status in inventory_items:
        print(f"{code:<12} {name:<20} {stock:<8} {safety:<8} {status:<10}")

    print("\n預警通知:")
    print("  ⚠️  P003 (記憶體) 低於安全庫存，建議補貨")
    print("  🔴 P004 (滑鼠) 嚴重不足，請立即採購")

def demo_financial_accounting():
    """財務會計系統示範"""
    print("\n" + "🟣" * 40)
    print("模組 4: 財務會計系統")
    print("🟣" * 40)

    print("""
💰 財務會計系統功能 (完整度: 95%):
   ✓ 會計科目管理
   ✓ 傳票錄入
   ✓ 自動過帳
   ✓ 財務報表生成
   ✓ 總帳/明細帳查詢

🚀 快速開始:
   cd financial-accounting
   pip install -r requirements.txt
   python example_usage.py

💡 核心功能展示:

1. 會計科目表
   - 資產類 (1xxx)
   - 負債類 (2xxx)
   - 權益類 (3xxx)
   - 收入類 (4xxx)
   - 費用類 (5xxx)

2. 會計流程:
   業務發生 → 錄入傳票 → 審核 → 過帳 → 生成報表

3. 財務報表:
   - 資產負債表
   - 損益表
   - 現金流量表
   - 試算表

4. 帳簿查詢:
   - 總分類帳
   - 明細分類帳
   - 日記帳
    """)

    # 模擬會計記錄
    print("\n【模擬：會計傳票】")
    print("\n傳票編號: V2025001")
    print("日期: 2025-11-17")
    print("摘要: 銷售筆記型電腦")
    print()
    print("借貸分錄:")
    print("─" * 60)
    print(f"{'科目代碼':<10} {'科目名稱':<20} {'借方':<12} {'貸方':<12}")
    print("─" * 60)
    print(f"{'1103':<10} {'應收帳款':<20} {'$50,000':<12} {'':<12}")
    print(f"{'4101':<10} {'銷貨收入':<20} {'':<12} {'$50,000':<12}")
    print("─" * 60)
    print(f"{'合計':<30} {'$50,000':<12} {'$50,000':<12}")

    print("\n過帳狀態: ✓ 已過帳")
    print("審核狀態: ✓ 已審核")

def demo_integrated_workflow():
    """整合業務流程示範"""
    print("\n" + "🌟" * 40)
    print("完整 ERP 業務流程整合示範")
    print("🌟" * 40)

    print("""
🔄 端到端業務流程:

【情境】公司接到客戶訂單並完成整個業務循環

階段 1: 銷售接單 (Sales Order System)
   ↓ 客戶: ABC 公司訂購筆記型電腦 50 台
   ↓ 創建銷售訂單: SO2025001
   ↓ 訂單金額: $250,000

階段 2: 庫存檢查 (Inventory Management)
   ↓ 查詢庫存: 筆記型電腦僅剩 20 台
   ↓ 需求數量: 50 台
   ↓ 缺口: 30 台
   ↓ 結論: 需要採購補貨

階段 3: 採購補貨 (Purchase Order System)
   ↓ 創建採購訂單: PO2025001
   ↓ 採購數量: 40 台 (含安全庫存)
   ↓ 供應商: XYZ 科技
   ↓ 採購金額: $160,000

階段 4: 收貨入庫 (Inventory Management)
   ↓ 供應商交貨
   ↓ 品質檢驗: 通過
   ↓ 入庫數量: 40 台
   ↓ 當前庫存: 60 台

階段 5: 銷貨出貨 (Sales Order System)
   ↓ 從庫存扣除: 50 台
   ↓ 剩餘庫存: 10 台
   ↓ 出貨給客戶
   ↓ 開立發票: INV2025001

階段 6: 財務記帳 (Financial Accounting)
   ↓ 銷售收入記帳:
      借: 應收帳款 $250,000
      貸: 銷貨收入 $250,000

   ↓ 採購成本記帳:
      借: 存貨 $160,000
      貸: 應付帳款 $160,000

   ↓ 銷貨成本記帳:
      借: 銷貨成本 $200,000
      貸: 存貨 $200,000

階段 7: 收付款管理
   ↓ 收到客戶付款: $250,000
      借: 銀行存款 $250,000
      貸: 應收帳款 $250,000

   ↓ 支付供應商: $160,000
      借: 應付帳款 $160,000
      貸: 銀行存款 $160,000

📊 最終結果:
   ✓ 銷售額: $250,000
   ✓ 銷貨成本: $200,000
   ✓ 毛利: $50,000
   ✓ 毛利率: 20%
   ✓ 庫存週轉完成
   ✓ 帳務記錄完整
    """)

def main():
    """主函數"""
    demo_sales_order_system()
    demo_purchase_order_system()
    demo_inventory_management()
    demo_financial_accounting()
    demo_integrated_workflow()

    print("\n" + "🎉" * 40)
    print("ERP 系統範例介紹完成！")
    print("🎉" * 40)

    print("""
📚 建議學習路徑:

1️⃣ 初級: 單一模組練習
   • 先從銷售訂單或採購訂單開始
   • 熟悉基本的業務流程
   • 理解數據結構和關聯

2️⃣ 中級: 跨模組整合
   • 練習銷售→庫存→財務的流程
   • 理解模組間的數據傳遞
   • 掌握業務單據的串聯

3️⃣ 高級: 完整系統運作
   • 實現端到端的業務流程
   • 優化系統性能
   • 添加報表分析功能

💡 實際操作建議:
   1. 依序進入各子目錄
   2. 執行 example_usage.py 熟悉功能
   3. 查看 README.md 了解詳細文檔
   4. 根據需求修改和擴展功能

🔗 模組關聯圖:

   ┌─────────────┐
   │ 銷售訂單    │────┐
   └─────────────┘    │
                      ├─────→ ┌─────────────┐
   ┌─────────────┐    │       │ 庫存管理    │
   │ 採購訂單    │────┘       └─────────────┘
   └─────────────┘                  │
         │                          │
         │                          ↓
         └──────────────→ ┌─────────────────┐
                         │ 財務會計        │
                         └─────────────────┘

📖 技術文檔:
   • 每個模組都有完整的 README
   • 查看 example_usage.py 獲取使用範例
   • 代碼註解詳細說明業務邏輯
    """)

if __name__ == '__main__':
    main()
